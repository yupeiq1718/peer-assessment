import{_ as w,a as x}from"./BaseFormSelect.aa63f696.js";import{_ as v}from"./BaseFormTag.ebf52899.js";import{_ as y}from"./BaseFormInput.15740f10.js";import{_ as E,d as U,m as A,i as c,x as I,f as N,w as b,u as n,o as q,a as T,b as t}from"./index.09a6d77f.js";import{u as o}from"./users.11ee2723.js";import{u as $}from"./vee-validate.esm.92c01090.js";import{d as k,r as S}from"./data.054ee288.js";import{c as V,a as r,d as L,b as j}from"./array.8d8f64ff.js";import"./BaseMessage.354e107b.js";import"./BaseSelect.d7f6cce8.js";import"./BaseTag.126a2c10.js";import"./BaseInput.926e03c0.js";import"./api.547c5d0a.js";const z={class:"m-2 grid grid-cols-1 lg:grid-cols-2 2xl:grid-cols-3 gap-4"},M=U({__name:"AdminUsersNew",setup(O){const l=V({department:r().required("\u6B64\u6B04\u4F4D\u5FC5\u586B"),name:r().required("\u6B64\u6B04\u4F4D\u5FC5\u586B"),email:r().required("\u6B64\u6B04\u4F4D\u5FC5\u586B").email("\u4E0D\u7B26\u5408\u96FB\u5B50\u90F5\u4EF6\u683C\u5F0F"),role:L().required("\u6B64\u6B04\u4F4D\u5FC5\u586B").min(1,"\u6700\u5C11\u9078\u64C7\u4E00\u9805"),managerId:j()}),{handleSubmit:p,resetForm:_}=$({initialValues:{department:"",email:"",name:"",role:[],managerId:0},validationSchema:l}),d=A(()=>{var e;return(e=o().users)==null?void 0:e.filter(s=>s.role.includes(2)).map(s=>({text:s.name,value:s.id}))}),u=c("setToastData",()=>null),a=c("setIsLoading",()=>null),B=I(),f=async()=>{try{a(!0);const e=await o().readUsers()}catch{}finally{a(!1)}},g=p(async e=>{try{a(!0);const s=await o().createUser(e);u({isActive:!0,variant:"success",message:"\u65B0\u589E\u6210\u529F"}),_(),f()}catch({response:s}){u({isActive:!0,variant:"error",message:"\u65B0\u589E\u5931\u6557"})}finally{a(!1)}}),F=()=>B.push("/admin/users");return(e,s)=>{const m=y,i=x,C=v,h=w;return q(),N(h,{size:"full",onConfirm:n(g),onCancel:F},{default:b(()=>[T("article",z,[t(m,{name:"name",type:"text",class:"col-span-1",title:"\u59D3\u540D"}),t(m,{type:"email",name:"email",class:"col-span-1",title:"\u96FB\u5B50\u90F5\u4EF6"}),t(i,{name:"department",options:n(k),class:"col-span-1",title:"\u90E8\u9580"},null,8,["options"]),t(i,{name:"managerId",options:n(d),class:"col-span-1",title:"\u4E3B\u7BA1"},null,8,["options"]),t(C,{name:"role",class:"col-span-1",title:"\u89D2\u8272",tags:n(S).map(D=>D.text)},null,8,["tags"])])]),_:1},8,["onConfirm"])}}}),te=E(M,[["__file","/home/runner/work/peer-assessment/peer-assessment/src/views/AdminUsersNew.vue"]]);export{te as default};
