import{_ as J,a as K}from"./TheSideBar.6e568260.js";import{_ as O}from"./BaseTable.93006757.js";import{_ as V,d as j,z as r,i as E,u as L,l as i,k as y,g as l,e as m,t as q,f as a,h as e,c as d,C as P,F as W,n as F,s as X,A as Y,b as Z,T as M,j as $,B as ee}from"./index.a32bcd10.js";import{_ as te}from"./BaseScore.46ec2b9e.js";import{_ as se}from"./BaseTag.a01f1525.js";import{u as x}from"./answers.c3da4145.js";import{u as Q}from"./account.ef632e62.js";import{g as T,d as ne}from"./data.ff9c2fa5.js";import{u as z}from"./system.37c5d4bb.js";import{u as N}from"./questions.aa957120.js";import{u as oe}from"./users.9a742a63.js";import"./api.359bc57d.js";const ae={class:"flex justify-start items-center"},re=["src"],ie={class:"text-sm 2xl:text-base"},le={class:"text-sm 2xl:text-base"},ue=["disabled","onClick"],ce=["disabled","onClick"],me=["disabled","onClick"],pe=j({__name:"EmployeeStaffMain",setup(R){const o=r(()=>z().systemStatus),g=r(()=>Q().accountId),b=[{name:"\u59D3\u540D",key:"profile"},{name:"\u90E8\u9580",key:"department",width:"20%"},{name:"\u8A55\u5206",key:"scores",width:"60%"},{name:"\u529F\u80FD",key:"function"}],k=r(()=>x().answersInformation(1)),A=r(()=>{var s;return(s=k.value)==null?void 0:s.map(n=>({profile:{name:n.reviewee.name,picture:n.reviewee.picture},department:n.reviewee.department,scores:n.answers.filter(w=>w.score===0||w.score),function:{id:n.id,isDone:n.isDone,reviewee:n.reviewee.id}}))}),f=s=>ne.findIndex(n=>s===n.value),v=E("setToastData",()=>null),h=E("setIsLoading",()=>null),c=async s=>{try{h(!0);const n=await x().deleteAnswersInformation(s);v({isActive:!0,variant:"success",message:"\u522A\u9664\u6210\u529F"}),x().readAnswersInformation({userId:g.value,qId:1})}catch{v({isActive:!0,variant:"error",message:"\u522A\u9664\u5931\u6557"})}finally{h(!1)}},u=L(),p=s=>u.push(`/employee/staff/edit/${s}`),C=s=>u.push(`/employee/staff/new?reviewee=${s}`),B=E("setConfirmData",()=>null),D=s=>{B({isActive:!0,confirm:()=>c(s),text:"\u8ACB\u78BA\u8A8D\u662F\u5426\u522A\u9664\u8A72\u7B46\u8CC7\u6599\uFF1F"})};return(s,n)=>{const w=se,U=te,G=J,I=X,H=O;return i(),y(H,{fields:b,items:e(A)},{profile:l(t=>[m("div",ae,[m("img",{class:"inline-block rounded-full w-14 2xl:w-16 max-w-none h-14 2xl:h-16 bg-light mx-3 2xl:mx-4",src:t.data.picture||"/user.png",alt:"user"},null,8,re),m("span",ie,q(t.data.name),1)])]),department:l(t=>[a(w,{variant:e(T)(f(t.data))},{default:l(()=>[m("span",le,q(t.data),1)]),_:2},1032,["variant"])]),scores:l(t=>[(i(!0),d(W,null,P(t.data,(_,S)=>(i(),d("div",{key:S,class:"relative group inline-block"},[a(U,{variant:e(T)(S),class:"w-16 2xl:w-18 h-16 2xl:h-18",score:_.score},null,8,["variant","score"]),a(G,{class:"absolute whitespace-nowrap left-1/2 bottom-18 2xl:bottom-20 -translate-x-1/2 opacity-0 group-hover:block lg:group-hover:opacity-100",variant:e(T)(S),text:_.tag},null,8,["variant","text"])]))),128))]),function:l(t=>[m("div",null,[e(o)==1&&!t.data.isDone?(i(),d("button",{key:0,disabled:e(o)!==1,class:F(e(o)==1?["fill-muted hover:fill-theme hover:animate-bounce"]:"fill-muted-light pointer-events-none"),onClick:_=>C(t.data.reviewee)},[a(I,{role:"button",class:"w-5 2xl:w-6 h-5 2xl:h-6 m-1 2xl:m-2",name:"edit"})],10,ue)):(i(),d("button",{key:1,disabled:e(o)!==1,class:F(e(o)==1?["fill-muted hover:fill-theme hover:animate-bounce"]:"fill-muted-light pointer-events-none"),onClick:_=>p(t.data.id)},[a(I,{role:"button",class:"w-5 2xl:w-6 h-5 2xl:h-6 m-1 2xl:m-2",name:"edit"})],10,ce)),m("button",{disabled:!(e(o)==1&&t.data.isDone),class:F(e(o)==1&&t.data.isDone?["fill-muted hover:fill-theme hover:animate-bounce"]:"fill-muted-light pointer-events-none"),onClick:_=>D(t.data.id)},[a(I,{role:"button",class:"w-5 2xl:w-6 h-5 2xl:h-6 m-1 2xl:m-2",name:"delete"})],10,me)])]),_:1},8,["items"])}}}),_e=V(pe,[["__file","/home/runner/work/peer-assessment/peer-assessment/src/components/EmployeeStaffMain.vue"]]),de={key:0,class:"absolute w-full h-full pt-6 px-4"},fe=j({__name:"EmployeeStaff",setup(R){const o=r(()=>z().systemStatus),g=r(()=>Q().accountId),b=L(),k=r(()=>o.value===1?[{name:"\u65B0\u589E",icon:"plus",function:()=>b.push("/employee/staff/new")}]:[]),A=async c=>{try{const u=await N().readQuestionnaire(c)}catch{}},f=r(()=>N().questionnaire(1)),v=async({userId:c,qId:u})=>{try{const p=await x().readAnswersInformation({userId:c,qId:u})}catch{}},h=r(()=>oe().users);return Y(()=>{A(1),v({userId:g.value,qId:1})}),(c,u)=>{const p=_e,C=K,B=Z("router-view");return e(h)?(i(),d("div",de,[a(p),a(M,{name:"sidebar",mode:"out-in",appear:""},{default:l(()=>[e(f)?(i(),y(C,{key:0,items:e(k)},null,8,["items"])):$("v-if",!0)]),_:1}),e(f)?(i(),y(B,{key:0},{default:l(({Component:D})=>[a(M,{name:"modal",mode:"out-in",appear:""},{default:l(()=>[(i(),y(ee(D)))]),_:2},1024)]),_:1})):$("v-if",!0)])):$("v-if",!0)}}}),Ie=V(fe,[["__file","/home/runner/work/peer-assessment/peer-assessment/src/views/EmployeeStaff.vue"]]);export{Ie as default};
