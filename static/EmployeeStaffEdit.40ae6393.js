import{_ as D}from"./TheModal.23fd6fef.js";import{_ as L}from"./EmployeeAnswer.8ea93956.js";import{_ as T}from"./BaseFormSelect.289b026c.js";import{_ as V,d as M,A as t,a as R,i as h,u as U,B as j,k as y,g as z,h as o,o as u,e as a,f as I,c as O,D as Q,F as $}from"./index.8e734258.js";import{u as G}from"./questions.1421bf41.js";import{u as l}from"./answers.2e22290b.js";import{u as H}from"./users.b6dbb148.js";import{u as J}from"./vee-validate.esm.ab02f1d5.js";import{d as K}from"./data.ff9c2fa5.js";import{u as P}from"./account.ad01628e.js";import{u as W}from"./system.e1a63dec.js";import"./BaseFormTextarea.67540c63.js";import"./BaseMessage.65557bd2.js";import"./BaseTextarea.cf1c2079.js";import"./BaseFormScore.8a8972b9.js";import"./BaseScore.e7909276.js";import"./BaseTag.89a34d38.js";import"./array.c60c04ee.js";import"./BaseSelect.f6080912.js";import"./api.5131a906.js";const X={class:"mx-5 mt-5 mb-2"},Y={class:"grid grid-cols-1 lg:grid-cols-2 2xl:grid-cols-3 gap-4"},Z=a("hr",{class:"border-1 border-theme my-4 w-full"},null,-1),ee={class:"grid grid-cols-1 lg:grid-cols-2 2xl:grid-cols-3 gap-4"},se=M({__name:"EmployeeStaffEdit",setup(te){var f,_,v;const b=t(()=>W().systemStatus),m=t(()=>P().accountId),c=R(),x=t(()=>G().questions(1)),r=t(()=>l().answerInformation({qId:1,id:Number(c.params.id)})),{values:F,handleSubmit:B,setFieldValue:n}=J();n("department",(f=r.value)==null?void 0:f.reviewee.department),n("reviewee",(_=r.value)==null?void 0:_.reviewee.id),n("answers",((v=r.value)==null?void 0:v.answers)||[]);const C=t(()=>{var e;return(e=H().activeUsers)==null?void 0:e.filter(s=>s.department===F.department&&s.roles.includes(1))}),E=t(()=>{var e;return(e=C.value)==null?void 0:e.map(s=>({text:s.name,value:s.id}))}),p=h("setToastData",()=>null),d=h("setIsLoading",()=>null),A=B(async e=>{try{d(!0);const s=await l().updateAnswers({id:Number(c.params.id),reviewer:m.value,qId:1,reviewee:Number(e.reviewee),answers:e.answers});p({isActive:!0,variant:"success",message:"\u66F4\u65B0\u6210\u529F"}),l().readAnswersInformation({userId:m.value,qId:1}),i.push("/employee/staff")}catch({response:s}){p({isActive:!0,variant:"error",message:"\u66F4\u65B0\u5931\u6557"})}finally{d(!1)}}),i=U(),S=()=>i.push("/employee/staff");return j(async()=>{b.value!==1&&i.push("/employee/staff")}),(e,s)=>{const w=T,k=L,N=D;return u(),y(N,{size:"full",onConfirm:o(A),onCancel:S},{default:z(()=>[a("article",X,[a("header",Y,[I(w,{name:"department",options:o(K),class:"col-span-1",title:"\u5408\u4F5C\u90E8\u9580",disabled:""},null,8,["options"]),I(w,{name:"reviewee",options:o(E),class:"col-span-1",title:"\u5408\u4F5C\u5C0D\u8C61",disabled:""},null,8,["options"])]),Z,a("article",ee,[(u(!0),O($,null,Q(o(x),(g,q)=>(u(),y(k,{id:g.id,key:g.id,index:q,"role-id":1,class:"col-span-1 lg:col-span-2 2xl:col-span-3"},null,8,["id","index"]))),128))])])]),_:1},8,["onConfirm"])}}}),xe=V(se,[["__file","/home/runner/work/peer-assessment/peer-assessment/src/views/EmployeeStaffEdit.vue"]]);export{xe as default};
