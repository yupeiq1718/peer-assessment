import{a as z}from"./TheSideBar.3f6676dc.js";import{_ as G}from"./BaseTable.13f3b5c8.js";import{_ as j,d as S,A as w,i as g,r as b,u as V,o as r,k as U,g as a,e as o,t as u,f as l,h as n,c as m,F as L,D as H,j as p,y as J,q as M,P as C,b as K,T,C as O}from"./index.a3870a76.js";import{_ as Q}from"./BaseTag.6a3ac365.js";import{u as k}from"./users.d8e39637.js";import{g as R,r as N,d as W}from"./data.ff9c2fa5.js";import"./api.52db123a.js";const X={class:"flex justify-start items-center"},Y=["src"],Z={class:"text-sm 2xl:text-base"},ee={class:"text-sm 2xl:text-base text-muted"},te={class:"text-sm 2xl:text-base"},se={class:"text-sm 2xl:text-base"},ne={key:0,class:"flex justify-start items-center"},ae=["src"],oe={class:"text-sm 2xl:text-base"},re=S({__name:"AdminUsersMain",setup(q){const f=[{name:"\u59D3\u540D",key:"profile"},{name:"\u96FB\u5B50\u4FE1\u7BB1",key:"email",width:"25%"},{name:"\u90E8\u9580",key:"department",width:"10%"},{name:"\u89D2\u8272",key:"roles",width:"25%"},{name:"\u4E3B\u7BA1",key:"manager"},{name:"\u529F\u80FD",key:"function"}],y=w(()=>k().activeUsers),x=g("filterDepartment",b("")),i=g("filterRoles",b(0)),c=w(()=>{var s;return(s=y.value)==null?void 0:s.filter(t=>(!x.value||t.department===x.value)&&(!i.value||t.roles.includes(i.value)))}),$=w(()=>{var s;return(s=c.value)==null?void 0:s.map(t=>({profile:{name:t.name,picture:t.picture},email:t.email,department:t.department,roles:t.roles,manager:t.manager,function:t.id}))}),h=s=>W.findIndex(t=>s===t.value),_=g("setToastData",()=>null),v=g("setIsLoading",()=>null),B=async s=>{try{v(!0);const t=await k().deleteUser(s);_({isActive:!0,variant:"success",message:"\u522A\u9664\u6210\u529F"}),await k().readUsers()}catch{_({isActive:!0,variant:"error",message:"\u522A\u9664\u5931\u6557"})}finally{v(!1)}},D=s=>{J().setConfirmData({isActive:!0,confirm:()=>B(s),text:"\u8ACB\u78BA\u8A8D\u662F\u5426\u522A\u9664\u8A72\u7B46\u8CC7\u6599\uFF1F"})},A=V(),F=s=>A.push(`/admin/users/edit/${s}`);return(s,t)=>{const E=Q,I=M,P=G;return r(),U(P,{fields:f,items:n($)},{profile:a(e=>[o("div",X,[o("img",{class:"inline-block rounded-full w-14 2xl:w-16 max-w-none h-14 2xl:h-16 bg-light mx-3 2xl:mx-4",src:e.data.picture||"/user.png",alt:"user"},null,8,Y),o("span",Z,u(e.data.name),1)])]),email:a(e=>[o("span",ee,u(e.data),1)]),department:a(e=>[l(E,{variant:n(R)(h(e.data))},{default:a(()=>[o("span",te,u(e.data),1)]),_:2},1032,["variant"])]),roles:a(e=>[(r(!0),m(L,null,H(e.data,d=>(r(),U(E,{key:d,variant:n(R)(d-1),class:"mx-1"},{default:a(()=>[o("span",se,u(n(N)[d-1].text),1)]),_:2},1032,["variant"]))),128))]),manager:a(e=>[e.data?(r(),m("div",ne,[o("img",{class:"inline-block rounded-full w-14 2xl:w-16 max-w-none h-14 2xl:h-16 bg-light mx-3 2xl:mx-4",src:e.data.picture||"/user.png",alt:"user"},null,8,ae),o("span",oe,u(e.data.name),1)])):p("v-if",!0)]),function:a(e=>[o("div",null,[l(I,{role:"button",class:"w-5 2xl:w-6 h-5 2xl:h-6 m-1 2xl:m-2 fill-muted hover:fill-theme hover:animate-bounce",name:"edit",onClick:d=>F(e.data)},null,8,["onClick"]),l(I,{role:"button",class:"w-5 2xl:w-6 h-5 2xl:h-6 m-1 2xl:m-2 fill-muted hover:fill-theme hover:animate-bounce",name:"delete",onClick:d=>D(e.data)},null,8,["onClick"])])]),_:1},8,["items"])}}}),le=j(re,[["__file","/home/runner/work/peer-assessment/peer-assessment/src/components/AdminUsersMain.vue"]]),ie={class:"absolute font-bold text-muted text-sm h-4 mb-2"},ue={key:0},ce={key:1},me={key:2},_e={key:0,class:"absolute top-8 left-0 w-full h-[calc(100%-2rem)] px-4 overflow-auto"},de=S({__name:"AdminUsers",setup(q){const f=V(),y=[{name:"\u65B0\u589E",icon:"plus",function:()=>f.push("/admin/users/new")},{name:"\u7BE9\u9078",icon:"filter",function:()=>f.push("/admin/users/filter")}],x=w(()=>k().users),i=b("");C("filterDepartment",i);const c=b(0);return C("filterRoles",c),C("setFilterData",({department:h,roles:_})=>{i.value=h,c.value=_}),(h,_)=>{const v=M,B=le,D=z,A=K("router-view");return r(),m(L,null,[o("span",ie,[l(v,{name:"users",class:"w-4 h-4 mr-2 fill-muted"}),!n(i)&&!n(c)?(r(),m("span",ue,u("\u5168\u90E8\u4F7F\u7528\u8005"))):p("v-if",!0),n(i)?(r(),m("span",ce,u(n(i)),1)):p("v-if",!0),n(c)?(r(),m("span",me,u(n(N)[n(c)-1].text),1)):p("v-if",!0)]),n(x)?(r(),m("div",_e,[l(B),l(T,{name:"sidebar",mode:"out-in",appear:""},{default:a(()=>[l(D,{items:y})]),_:1}),l(A,null,{default:a(({Component:F})=>[l(T,{name:"modal",mode:"out-in",appear:""},{default:a(()=>[(r(),U(O(F)))]),_:2},1024)]),_:1})])):p("v-if",!0)],64)}}}),ke=j(de,[["__file","/home/runner/work/peer-assessment/peer-assessment/src/views/AdminUsers.vue"]]);export{ke as default};
