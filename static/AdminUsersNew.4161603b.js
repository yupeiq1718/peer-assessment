import{_ as D,a as v}from"./BaseFormSelect.33cd8e56.js";import{_ as w}from"./BaseFormTag.4e15939d.js";import{_ as x}from"./BaseFormInput.4dc8fc71.js";import{_ as E,d as U,z as A,i as c,u as y,k as N,g as k,h as a,l as q,e as I,f as t}from"./index.d6278b14.js";import{u as o}from"./users.9e6e331b.js";import{u as T}from"./vee-validate.esm.5d1308fa.js";import{d as S,r as V}from"./data.054ee288.js";import{c as $,a as n,d as b}from"./array.c2782329.js";import"./BaseMessage.42ad9d57.js";import"./BaseSelect.ffb14c8f.js";import"./BaseTag.fad333f2.js";import"./BaseInput.aa78664e.js";import"./api.14d1c8a9.js";const z={class:"m-2 grid grid-cols-1 lg:grid-cols-2 2xl:grid-cols-3 gap-4"},L=U({__name:"AdminUsersNew",setup(j){const l=$({department:n().required("\u6B64\u6B04\u4F4D\u5FC5\u586B"),name:n().required("\u6B64\u6B04\u4F4D\u5FC5\u586B"),email:n().required("\u6B64\u6B04\u4F4D\u5FC5\u586B").email("\u4E0D\u7B26\u5408\u96FB\u5B50\u90F5\u4EF6\u683C\u5F0F"),role:b().required("\u6B64\u6B04\u4F4D\u5FC5\u586B").min(1,"\u6700\u5C11\u9078\u64C7\u4E00\u9805")}),{handleSubmit:p,resetForm:_}=T({initialValues:{department:"",email:"",name:"",role:[]},validationSchema:l}),d=A(()=>{var s;return(s=o().activeUsers)==null?void 0:s.filter(e=>e.role.includes(2)).map(e=>({text:e.name,value:e.id}))}),u=c("setToastData",()=>null),r=c("setIsLoading",()=>null),B=y(),f=p(async s=>{try{r(!0);const e=await o().createUser(s);u({isActive:!0,variant:"success",message:"\u65B0\u589E\u6210\u529F"}),_(),await o().readUsers()}catch({response:e}){u({isActive:!0,variant:"error",message:"\u65B0\u589E\u5931\u6557"})}finally{r(!1)}}),F=()=>B.push("/admin/users");return(s,e)=>{const i=x,m=v,g=w,C=D;return q(),N(C,{size:"full",onConfirm:a(f),onCancel:F},{default:k(()=>[I("article",z,[t(i,{name:"name",type:"text",class:"col-span-1",title:"\u59D3\u540D"}),t(i,{type:"email",name:"email",class:"col-span-1",title:"\u96FB\u5B50\u90F5\u4EF6"}),t(m,{name:"department",options:a(S),class:"col-span-1",title:"\u90E8\u9580"},null,8,["options"]),t(m,{name:"managerId",options:a(d),class:"col-span-1",title:"\u4E3B\u7BA1"},null,8,["options"]),t(g,{name:"role",class:"col-span-1",title:"\u89D2\u8272",tags:a(V).map(h=>h.text)},null,8,["tags"])])]),_:1},8,["onConfirm"])}}}),ee=E(L,[["__file","/home/runner/work/peer-assessment/peer-assessment/src/views/AdminUsersNew.vue"]]);export{ee as default};
