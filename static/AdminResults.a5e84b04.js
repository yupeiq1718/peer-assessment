import{_ as S,a as V}from"./TheSideBar.d95b1161.js";import{_ as L}from"./BaseTable.8a5fd54a.js";import{_ as j}from"./BaseScore.e7909276.js";import{_ as q}from"./BaseTag.89a34d38.js";import{_ as N,d as R,A as b,o as p,k as F,g as c,e as u,t as d,f as o,h as i,c as I,F as T,D as O,u as P,r as z,P as D,i as G,w as J,B as K,b as Q,l as U,T as H,C as W,q as X}from"./index.8e734258.js";import{u as _}from"./history.0fcab23f.js";import{g as w,d as Y,r as Z}from"./data.ff9c2fa5.js";import"./api.5131a906.js";const ee={class:"flex justify-start items-center"},te=["src"],se={class:"text-sm 2xl:text-base"},ae={class:"text-sm 2xl:text-base"},ne=R({__name:"AdminResultsMain",setup(C){const f=[{name:"\u59D3\u540D",key:"profile"},{name:"\u90E8\u9580",key:"department",width:"15%"},{name:"\u8A55\u5206",key:"scores",width:"60%"}],v=b(()=>_().allHistoryScore),y=b(()=>{var r;return(r=v.value)==null?void 0:r.map(n=>({profile:{name:n.name,picture:n.picture},department:n.department,function:n.id,scores:n.scores}))}),t=r=>Y.findIndex(n=>r===n.value);return(r,n)=>{const l=q,h=j,x=S,g=L;return p(),F(g,{fields:f,items:i(y)},{profile:c(e=>[u("div",ee,[u("img",{class:"inline-block rounded-full w-14 2xl:w-16 max-w-none h-14 2xl:h-16 bg-light mx-3 2xl:mx-4",src:e.data.picture||"/user.png",alt:"user"},null,8,te),u("span",se,d(e.data.name),1)])]),department:c(e=>[o(l,{variant:i(w)(t(e.data))},{default:c(()=>[u("span",ae,d(e.data),1)]),_:2},1032,["variant"])]),scores:c(e=>[(p(!0),I(T,null,O(e.data,(s,a)=>(p(),I("div",{key:a,class:"relative group inline-block"},[o(h,{variant:i(w)(a),class:"w-16 2xl:w-18 h-16 2xl:h-18",score:s.average},null,8,["variant","score"]),o(x,{class:"absolute whitespace-nowrap left-1/2 bottom-18 2xl:bottom-20 -translate-x-1/2 opacity-0 group-hover:block lg:group-hover:opacity-100",variant:i(w)(a),text:s.tag},null,8,["variant","text"])]))),128))]),_:1},8,["items"])}}}),oe=N(ne,[["__file","/home/runner/work/peer-assessment/peer-assessment/src/components/AdminResultsMain.vue"]]),re={class:"absolute font-bold text-muted text-sm h-4 mb-2"},le={class:"absolute w-full h-full pt-6 px-4"},ie=R({__name:"AdminResults",setup(C){const f=b(()=>_().histories),v=Z.slice(0,2),y=P(),t=z(),r=e=>{t.value=e};D("historyFilterData",t),D("setHistoryFilterData",r);const n=[{name:"\u4E0B\u8F09",icon:"download",function:()=>{var e,s,a;return g({year:((e=t.value)==null?void 0:e.year)||NaN,filename:((s=t.value)==null?void 0:s.filename)||"",roleId:((a=t.value)==null?void 0:a.roleId)||NaN})}},{name:"\u7BE9\u9078",icon:"filter",function:()=>y.push("/admin/results/filter")}],l=G("setIsLoading",()=>null),h=async()=>{try{l(!0);const e=await _().readHistory()}catch{}finally{l(!1)}},x=async({year:e,filename:s,roleId:a})=>{try{l(!0);const m=await _().readAllHistoryScore({year:Number(e),filename:s,roleId:Number(a)})}catch{}finally{l(!1)}},g=async({year:e,filename:s,roleId:a})=>{try{l(!0);const m=await _().readAllHistoryReport({year:Number(e),filename:s,roleId:Number(a)})}catch{}finally{l(!1)}};return J(()=>t.value,()=>{var e,s,a;((e=t.value)==null?void 0:e.year)&&((s=t.value)==null?void 0:s.filename)&&((a=t.value)==null?void 0:a.roleId)&&x({year:t.value.year,filename:t.value.filename,roleId:t.value.roleId})}),K(async()=>{var e,s;await h(),r({year:(e=f.value)==null?void 0:e[0].year,filename:(s=f.value)==null?void 0:s[0].filename[0],roleId:v[0].value})}),(e,s)=>{var B,k,A;const a=X,m=oe,E=V,$=Q("router-view");return p(),I(T,null,[u("span",re,[o(a,{name:"result",class:"w-4 h-4 mr-2 fill-muted"}),U(d(i(v)[(((B=i(t))==null?void 0:B.roleId)||1)-1].text)+"\u4E92\u8A55\u7D50\u679C/"+d((k=i(t))==null?void 0:k.year)+"\u5E74/"+d((A=i(t))==null?void 0:A.filename),1)]),u("div",le,[o(m),o(H,{name:"sidebar",mode:"out-in",appear:""},{default:c(()=>[o(E,{items:n})]),_:1}),o($,null,{default:c(({Component:M})=>[o(H,{name:"modal",mode:"out-in",appear:""},{default:c(()=>[(p(),F(W(M)))]),_:2},1024)]),_:1})])],64)}}}),ye=N(ie,[["__file","/home/runner/work/peer-assessment/peer-assessment/src/views/AdminResults.vue"]]);export{ye as default};
