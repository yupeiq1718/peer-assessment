import{_ as L,a as N}from"./BaseFormSelect.08572095.js";import{_ as k}from"./EmployeeAnswer.1625bb70.js";import{_ as $,d as S,m as r,i as _,x as T,f,w as U,u as o,o as a,a as V,b as w,c as j,v as z,F as M}from"./index.82aa29db.js";import{u as O}from"./questions.0bde0038.js";import{u as n}from"./answers.c2eb1af4.js";import{u as Q}from"./users.586efed2.js";import{u as R}from"./vee-validate.esm.e274b428.js";import{c as v,a as B,b as u,d as G}from"./array.07edf848.js";import{d as H}from"./data.054ee288.js";import"./BaseMessage.e0467a3b.js";import"./BaseSelect.a335e977.js";import"./BaseFormTextarea.ae8a5ef5.js";import"./BaseTextarea.b5e3db33.js";import"./BaseFormScore.ca2fa172.js";import"./BaseScore.f12b3f8d.js";import"./BaseTag.cfb2bf7b.js";import"./api.ea9e52da.js";const J={class:"mx-5 mt-5 mb-2 grid grid-cols-1 lg:grid-cols-2 2xl:grid-cols-3 gap-4"},K=S({__name:"EmployeeLeaderNew",setup(P){var p;const i=r(()=>O().questions(2)),g=v().shape({department:B().required("\u6B64\u6B04\u4F4D\u5FC5\u586B"),reviewee:u().required("\u6B64\u6B04\u4F4D\u5FC5\u586B"),answers:G().of(v({qId:u().required("\u6B64\u6B04\u4F4D\u5FC5\u586B"),score:u(),comment:B()}))}),C={department:"\u7814\u767C\u90E8",reviewee:0,answers:((p=i.value)==null?void 0:p.map(e=>({qId:e.id,score:0,comment:""})))||[]},{values:F,handleSubmit:h}=R({initialValues:C,validationSchema:g}),x=r(()=>{var e;return(e=Q().users)==null?void 0:e.filter(s=>s.department===F.department&&s.role.includes(2))}),y=r(()=>n().answerUsers(2)),E=r(()=>{var e;return(e=x.value)==null?void 0:e.filter(s=>{var t;return!((t=y.value)!=null&&t.includes(s.id))}).map(s=>({text:s.name,value:s.id}))}),c=_("setToastData",()=>null),m=_("setIsLoading",()=>null),q=h(async e=>{try{m(!0);const s=await n().createAnswers({reviewer:1,qId:2,reviewee:Number(e.reviewee),answers:e.answers});c({isActive:!0,variant:"success",message:"\u65B0\u589E\u6210\u529F"}),n().readAnswersInformation({userId:1,qId:2}),l.push("/employee/leader")}catch({response:s}){c({isActive:!0,variant:"error",message:"\u65B0\u589E\u5931\u6557"})}finally{m(!1)}}),l=T(),I=()=>l.push("/employee/leader");return(e,s)=>{const t=N,b=k,A=L;return a(),f(A,{size:"full",onConfirm:o(q),onCancel:I},{default:U(()=>[V("article",J,[w(t,{name:"department",options:o(H),class:"col-span-1",title:"\u5408\u4F5C\u90E8\u9580"},null,8,["options"]),w(t,{name:"reviewee",options:o(E),class:"col-span-1",title:"\u5408\u4F5C\u5C0D\u8C61"},null,8,["options"]),(a(!0),j(M,null,z(o(i),(d,D)=>(a(),f(b,{id:d.id,key:d.id,index:D,"role-id":2,class:"col-span-1 lg:col-span-2 2xl:col-span-3"},null,8,["id","index"]))),128))])]),_:1},8,["onConfirm"])}}}),de=$(K,[["__file","/home/runner/work/peer-assessment/peer-assessment/src/views/EmployeeLeaderNew.vue"]]);export{de as default};
