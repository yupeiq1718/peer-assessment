import{_ as J,a as K}from"./TheSideBar.6e568260.js";import{_ as O}from"./BaseTable.93006757.js";import{_ as N,d as V,z as r,i as F,u as j,l as i,k as y,g as l,e as m,t as T,f as a,h as e,c as _,C as P,F as W,n as $,s as X,A as Y,b as Z,T as q,j as L,B as ee}from"./index.a32bcd10.js";import{_ as te}from"./BaseScore.46ec2b9e.js";import{_ as se}from"./BaseTag.a01f1525.js";import{u as x}from"./answers.c3da4145.js";import{u as Q}from"./account.ef632e62.js";import{g as S,d as ne}from"./data.ff9c2fa5.js";import{u as z}from"./system.37c5d4bb.js";import{u as M}from"./questions.aa957120.js";import{u as oe}from"./users.9a742a63.js";import"./api.359bc57d.js";const ae={class:"flex justify-start items-center"},re=["src"],ie={class:"text-sm 2xl:text-base"},le={class:"text-sm 2xl:text-base"},ue=["disabled","onClick"],ce=["disabled","onClick"],me=["disabled","onClick"],de=V({__name:"EmployeeLeaderMain",setup(R){const o=r(()=>z().systemStatus),g=r(()=>Q().accountId),b=[{name:"\u59D3\u540D",key:"profile"},{name:"\u90E8\u9580",key:"department",width:"20%"},{name:"\u8A55\u5206",key:"scores",width:"60%"},{name:"\u529F\u80FD",key:"function"}],k=r(()=>x().answersInformation(2)),A=r(()=>{var s;return(s=k.value)==null?void 0:s.map(n=>({profile:{name:n.reviewee.name,picture:n.reviewee.picture},department:n.reviewee.department,scores:n.answers.filter(w=>w.score===0||w.score),function:{id:n.id,isDone:n.isDone,reviewee:n.reviewee.id}}))}),f=s=>ne.findIndex(n=>s===n.value),v=F("setToastData",()=>null),h=F("setIsLoading",()=>null),c=async s=>{try{h(!0);const n=await x().deleteAnswersInformation(s);v({isActive:!0,variant:"success",message:"\u522A\u9664\u6210\u529F"}),x().readAnswersInformation({userId:g.value,qId:2})}catch{v({isActive:!0,variant:"error",message:"\u522A\u9664\u5931\u6557"})}finally{h(!1)}},u=j(),d=s=>u.push(`/employee/leader/edit/${s}`),C=s=>u.push(`/employee/leader/new?reviewee=${s}`),B=F("setConfirmData",()=>null),D=s=>{B({isActive:!0,confirm:()=>c(s),text:"\u8ACB\u78BA\u8A8D\u662F\u5426\u522A\u9664\u8A72\u7B46\u8CC7\u6599\uFF1F"})};return(s,n)=>{const w=se,U=te,G=J,I=X,H=O;return i(),y(H,{fields:b,items:e(A)},{profile:l(t=>[m("div",ae,[m("img",{class:"inline-block rounded-full w-14 2xl:w-16 max-w-none h-14 2xl:h-16 bg-light mx-3 2xl:mx-4",src:t.data.picture||"/user.png",alt:"user"},null,8,re),m("span",ie,T(t.data.name),1)])]),department:l(t=>[a(w,{variant:e(S)(f(t.data))},{default:l(()=>[m("span",le,T(t.data),1)]),_:2},1032,["variant"])]),scores:l(t=>[(i(!0),_(W,null,P(t.data,(p,E)=>(i(),_("div",{key:E,class:"relative group inline-block"},[a(U,{variant:e(S)(E),class:"w-16 2xl:w-18 h-16 2xl:h-18",score:p.score},null,8,["variant","score"]),a(G,{class:"absolute whitespace-nowrap left-1/2 bottom-18 2xl:bottom-20 -translate-x-1/2 opacity-0 group-hover:block lg:group-hover:opacity-100",variant:e(S)(E),text:p.tag},null,8,["variant","text"])]))),128))]),function:l(t=>[m("div",null,[e(o)==1&&!t.data.isDone?(i(),_("button",{key:0,disabled:e(o)!==1,class:$(e(o)==1?["fill-muted hover:fill-theme hover:animate-bounce"]:"fill-muted-light pointer-events-none"),onClick:p=>C(t.data.reviewee)},[a(I,{role:"button",class:"w-5 2xl:w-6 h-5 2xl:h-6 m-1 2xl:m-2",name:"edit"})],10,ue)):(i(),_("button",{key:1,disabled:e(o)!==1,class:$(e(o)==1?["fill-muted hover:fill-theme hover:animate-bounce"]:"fill-muted-light pointer-events-none"),onClick:p=>d(t.data.id)},[a(I,{role:"button",class:"w-5 2xl:w-6 h-5 2xl:h-6 m-1 2xl:m-2",name:"edit"})],10,ce)),m("button",{disabled:!(e(o)==1&&t.data.isDone),class:$(e(o)==1&&t.data.isDone?["fill-muted hover:fill-theme hover:animate-bounce"]:"fill-muted-light pointer-events-none"),onClick:p=>D(t.data.id)},[a(I,{role:"button",class:"w-5 2xl:w-6 h-5 2xl:h-6 m-1 2xl:m-2",name:"delete"})],10,me)])]),_:1},8,["items"])}}}),pe=N(de,[["__file","/home/runner/work/peer-assessment/peer-assessment/src/components/EmployeeLeaderMain.vue"]]),_e={key:0,class:"absolute w-full h-full pt-6 px-4"},fe=V({__name:"EmployeeLeader",setup(R){const o=r(()=>z().systemStatus),g=r(()=>Q().accountId),b=j(),k=r(()=>o.value===1?[{name:"\u65B0\u589E",icon:"plus",function:()=>b.push("/employee/leader/new")}]:[]),A=async c=>{try{const u=await M().readQuestionnaire(c)}catch{}},f=r(()=>M().questionnaire(2)),v=async({userId:c,qId:u})=>{try{const d=await x().readAnswersInformation({userId:c,qId:u})}catch{}},h=r(()=>oe().users);return Y(()=>{A(2),v({userId:g.value,qId:2})}),(c,u)=>{const d=pe,C=K,B=Z("router-view");return e(h)?(i(),_("div",_e,[a(d),a(q,{name:"sidebar",mode:"out-in",appear:""},{default:l(()=>[e(f)?(i(),y(C,{key:0,items:e(k)},null,8,["items"])):L("v-if",!0)]),_:1}),e(f)?(i(),y(B,{key:0},{default:l(({Component:D})=>[a(q,{name:"modal",mode:"out-in",appear:""},{default:l(()=>[(i(),y(ee(D)))]),_:2},1024)]),_:1})):L("v-if",!0)])):L("v-if",!0)}}}),Ie=N(fe,[["__file","/home/runner/work/peer-assessment/peer-assessment/src/views/EmployeeLeader.vue"]]);export{Ie as default};
