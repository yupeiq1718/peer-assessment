import{_ as w,a as A}from"./BaseFormSelect.600aef34.js";import{_ as q}from"./BaseFormTag.2e03072d.js";import{_ as N}from"./BaseFormInput.96120e51.js";import{_ as S,d as T,i as f,S as k,m as F,x as I,f as V,w as $,u as n,o as L,a as R,b as t}from"./index.afca9dea.js";import{u as o}from"./users.5cc855d4.js";import{d as j,r as z}from"./data.054ee288.js";import{u as M}from"./vee-validate.esm.eb2f773f.js";import{c as G,a as u,d as H}from"./array.d7216b27.js";import"./BaseMessage.2ae6a500.js";import"./BaseSelect.55c818e4.js";import"./BaseTag.abb97a7f.js";import"./BaseInput.c6f13d3f.js";import"./api.b6312681.js";const J={class:"m-2 grid grid-cols-1 lg:grid-cols-2 2xl:grid-cols-3 gap-4"},K=T({__name:"AdminUsersEdit",setup(O){var c,l,p,d;const r=f("setToastData",()=>null),s=f("setIsLoading",()=>null),g=k(),m=F(()=>g.params.id),a=F(()=>o().user(Number(m.value))),h=G({department:u().required("\u6B64\u6B04\u4F4D\u5FC5\u586B"),name:u().required("\u6B64\u6B04\u4F4D\u5FC5\u586B"),email:u().required("\u6B64\u6B04\u4F4D\u5FC5\u586B").email("\u4E0D\u7B26\u5408\u96FB\u5B50\u90F5\u4EF6\u683C\u5F0F"),role:H().required("\u6B64\u6B04\u4F4D\u5FC5\u586B").min(1,"\u6700\u5C11\u9078\u64C7\u4E00\u9805")}),{handleSubmit:v}=M({initialValues:{department:((c=a.value)==null?void 0:c.department)||"",email:((l=a.value)==null?void 0:l.email)||"",name:((p=a.value)==null?void 0:p.name)||"",role:((d=a.value)==null?void 0:d.role)||[]},validationSchema:h}),C=async()=>{try{s(!0);const e=await o().readUsers()}catch{}finally{s(!1)}},D=v(async e=>{try{s(!0);const _=await o().updateUser({id:Number(m.value),user:{name:e.name,department:e.department}});r({isActive:!0,variant:"success",message:"\u66F4\u65B0\u6210\u529F"}),i.push("/admin/users"),C()}catch({response:_}){r({isActive:!0,variant:"error",message:"\u66F4\u65B0\u5931\u6557"})}finally{s(!1)}}),i=I(),x=()=>i.push("/admin/users");return(e,_)=>{const B=N,y=A,E=q,b=w;return L(),V(b,{size:"full",onConfirm:n(D),onCancel:x},{default:$(()=>[R("article",J,[t(B,{name:"name",type:"text",class:"col-span-1",title:"\u59D3\u540D"}),t(B,{name:"email",class:"col-span-1",type:"email",title:"\u96FB\u5B50\u90F5\u4EF6",disabled:""}),t(y,{name:"department",options:n(j),class:"col-span-1",title:"\u90E8\u9580"},null,8,["options"]),t(E,{name:"role",class:"col-span-1 lg:col-span-2 2xl:col-span-3",title:"\u89D2\u8272",tags:n(z).map(U=>U.text),disabled:""},null,8,["tags"])])]),_:1},8,["onConfirm"])}}}),re=S(K,[["__file","/home/runner/work/peer-assessment/peer-assessment/src/views/AdminUsersEdit.vue"]]);export{re as default};
