import{_ as G,a as H}from"./TheSideBar.d1d94cb3.js";import{_ as J}from"./BaseTable.a4c10453.js";import{_ as M,d as V,z as o,i as B,u as j,l as i,k as v,g as a,e as u,t as F,f as r,h as s,c as D,C as K,F as O,n as T,s as P,A as W,b as X,T as $,j as C,B as Y}from"./index.f689cf9e.js";import{_ as Z}from"./BaseScore.a0178e23.js";import{_ as ee}from"./BaseTag.d6f7bee9.js";import{u as h}from"./answers.bd5f15d3.js";import{u as L}from"./account.390f12b3.js";import{g as S,d as te}from"./data.ff9c2fa5.js";import{u as N}from"./system.8ba5b3c0.js";import{u as q}from"./questions.2554ab8a.js";import{u as se}from"./users.5f05567c.js";import"./api.80204498.js";const ne={class:"flex justify-start items-center"},oe=["src"],ae={class:"text-sm 2xl:text-base"},re={class:"text-sm 2xl:text-base"},ue=["disabled","onClick"],ie=["disabled","onClick"],ce=V({__name:"EmployeeStaffMain",setup(Q){const c=o(()=>N().systemStatus),w=o(()=>L().accountId),y=[{name:"\u59D3\u540D",key:"profile"},{name:"\u90E8\u9580",key:"department",width:"20%"},{name:"\u8A55\u5206",key:"scores",width:"60%"},{name:"\u529F\u80FD",key:"function"}],x=o(()=>{var e;return(e=h().answersInformation(1))==null?void 0:e.map(t=>({profile:{name:t.reviewee.name,picture:t.reviewee.picture},department:t.reviewee.department,scores:t.answers.filter(A=>A.score),function:t.id}))}),g=e=>te.findIndex(t=>e===t.value),p=B("setToastData",()=>null),d=B("setIsLoading",()=>null),b=async e=>{try{d(!0);const t=await h().deleteAnswersInformation(e);p({isActive:!0,variant:"success",message:"\u522A\u9664\u6210\u529F"}),h().readAnswersInformation({userId:w.value,qId:1})}catch{p({isActive:!0,variant:"error",message:"\u522A\u9664\u5931\u6557"})}finally{d(!1)}},l=j(),m=e=>l.push(`/employee/staff/edit/${e}`),_=B("setConfirmData",()=>null),k=e=>{_({isActive:!0,confirm:()=>b(e),text:"\u8ACB\u78BA\u8A8D\u662F\u5426\u522A\u9664\u8A72\u7B46\u8CC7\u6599\uFF1F"})};return(e,t)=>{const A=ee,z=Z,R=G,E=P,U=J;return i(),v(U,{fields:y,items:s(x)},{profile:a(n=>[u("div",ne,[u("img",{class:"inline-block rounded-full w-14 2xl:w-16 max-w-none h-14 2xl:h-16 bg-light mx-3 2xl:mx-4",src:n.data.picture||"/user.png",alt:"user"},null,8,oe),u("span",ae,F(n.data.name),1)])]),department:a(n=>[r(A,{variant:s(S)(g(n.data))},{default:a(()=>[u("span",re,F(n.data),1)]),_:2},1032,["variant"])]),scores:a(n=>[(i(!0),D(O,null,K(n.data,(f,I)=>(i(),D("div",{key:I,class:"relative group inline-block"},[r(z,{variant:s(S)(I),class:"w-16 2xl:w-18 h-16 2xl:h-18",score:f.score},null,8,["variant","score"]),r(R,{class:"absolute whitespace-nowrap left-1/2 bottom-18 2xl:bottom-20 -translate-x-1/2 opacity-0 group-hover:block lg:group-hover:opacity-100",variant:s(S)(I),text:f.tag},null,8,["variant","text"])]))),128))]),function:a(n=>[u("div",null,[u("button",{disabled:s(c)!==1,class:T(s(c)==1?["fill-muted hover:fill-theme hover:animate-bounce"]:"fill-muted-light pointer-events-none"),onClick:f=>m(n.data)},[r(E,{role:"button",class:"w-5 2xl:w-6 h-5 2xl:h-6 m-1 2xl:m-2",name:"edit"})],10,ue),u("button",{disabled:s(c)!==1,class:T(s(c)==1?["fill-muted hover:fill-theme hover:animate-bounce"]:"fill-muted-light pointer-events-none"),onClick:f=>k(n.data)},[r(E,{role:"button",class:"w-5 2xl:w-6 h-5 2xl:h-6 m-1 2xl:m-2",name:"delete"})],10,ie)])]),_:1},8,["items"])}}}),le=M(ce,[["__file","/home/runner/work/peer-assessment/peer-assessment/src/components/EmployeeStaffMain.vue"]]),me={key:0,class:"absolute w-full h-full pt-6 px-4"},pe=V({__name:"EmployeeStaff",setup(Q){const c=o(()=>N().systemStatus),w=o(()=>L().accountId),y=j(),x=o(()=>c.value===1?[{name:"\u65B0\u589E",icon:"plus",function:()=>y.push("/employee/staff/new")}]:[]),g=async l=>{try{const m=await q().readQuestionnaire(l)}catch{}},p=o(()=>q().questionnaire(1)),d=async({userId:l,qId:m})=>{try{const _=await h().readAnswersInformation({userId:l,qId:m})}catch{}},b=o(()=>se().users);return W(()=>{g(1),d({userId:w.value,qId:1})}),(l,m)=>{const _=le,k=H,e=X("router-view");return s(b)?(i(),D("div",me,[r(_),r($,{name:"sidebar",mode:"out-in",appear:""},{default:a(()=>[s(p)?(i(),v(k,{key:0,items:s(x)},null,8,["items"])):C("v-if",!0)]),_:1}),s(p)?(i(),v(e,{key:0},{default:a(({Component:t})=>[r($,{name:"modal",mode:"out-in",appear:""},{default:a(()=>[(i(),v(Y(t)))]),_:2},1024)]),_:1})):C("v-if",!0)])):C("v-if",!0)}}}),Ie=M(pe,[["__file","/home/runner/work/peer-assessment/peer-assessment/src/views/EmployeeStaff.vue"]]);export{Ie as default};
