import{_ as R,a as F}from"./TheSideBar.eda7b450.js";import{_ as T}from"./BaseTable.5ea999e3.js";import{_ as C}from"./BaseScore.f3c5d5f6.js";import{_ as E}from"./BaseTag.b98ea2cf.js";import{_ as B,d as A,A as w,o as u,k as H,g as i,e as m,t as b,f as l,h as p,c as g,D as M,F as $,u as L,r as S,P as N,i as V,w as j,B as P,b as q,T as k,C as z}from"./index.d57fffa1.js";import{u as _}from"./history.0893033d.js";import{g as x,d as G}from"./data.ff9c2fa5.js";import"./api.749027f8.js";const J={class:"flex justify-start items-center"},K=["src"],O={class:"text-sm 2xl:text-base"},Q={class:"text-sm 2xl:text-base"},U=A({__name:"AdminResultsMain",setup(I){const d=[{name:"\u59D3\u540D",key:"profile"},{name:"\u90E8\u9580",key:"department",width:"15%"},{name:"\u8A55\u5206",key:"scores",width:"60%"}],n=w(()=>_().allHistoryScore),f=w(()=>{var s;return(s=n.value)==null?void 0:s.map(o=>({profile:{name:o.name,picture:o.picture},department:o.department,function:o.id,scores:o.scores}))}),y=s=>G.findIndex(o=>s===o.value);return(s,o)=>{const v=E,h=C,t=R,a=T;return u(),H(a,{fields:d,items:p(f)},{profile:i(e=>[m("div",J,[m("img",{class:"inline-block rounded-full w-14 2xl:w-16 max-w-none h-14 2xl:h-16 bg-light mx-3 2xl:mx-4",src:e.data.picture||"/user.png",alt:"user"},null,8,K),m("span",O,b(e.data.name),1)])]),department:i(e=>[l(v,{variant:p(x)(y(e.data))},{default:i(()=>[m("span",Q,b(e.data),1)]),_:2},1032,["variant"])]),scores:i(e=>[(u(!0),g($,null,M(e.data,(r,c)=>(u(),g("div",{key:c,class:"relative group inline-block"},[l(h,{variant:p(x)(c),class:"w-16 2xl:w-18 h-16 2xl:h-18",score:r.average},null,8,["variant","score"]),l(t,{class:"absolute whitespace-nowrap left-1/2 bottom-18 2xl:bottom-20 -translate-x-1/2 opacity-0 group-hover:block lg:group-hover:opacity-100",variant:p(x)(c),text:r.tag},null,8,["variant","text"])]))),128))]),_:1},8,["items"])}}}),W=B(U,[["__file","/home/runner/work/peer-assessment/peer-assessment/src/components/AdminResultsMain.vue"]]),X={class:"absolute w-full h-full pt-6 px-4"},Y=A({__name:"AdminResults",setup(I){const d=L(),n=S(),f=t=>{n.value=t};N("historyFilterData",n),N("setHistoryFilterData",f);const y=[{name:"\u4E0B\u8F09",icon:"download",function:()=>{var t,a,e;return h({year:((t=n.value)==null?void 0:t.year)||NaN,filename:((a=n.value)==null?void 0:a.filename)||"",roleId:((e=n.value)==null?void 0:e.roleId)||NaN})}},{name:"\u7BE9\u9078",icon:"filter",function:()=>d.push("/admin/results/filter")}],s=V("setIsLoading",()=>null),o=async()=>{try{s(!0);const t=await _().readHistory()}catch{}finally{s(!1)}},v=async({year:t,filename:a,roleId:e})=>{try{s(!0);const r=await _().readAllHistoryScore({year:Number(t),filename:a,roleId:Number(e)})}catch{}finally{s(!1)}},h=async({year:t,filename:a,roleId:e})=>{try{s(!0);const r=await _().readAllHistoryReport({year:Number(t),filename:a,roleId:Number(e)})}catch{}finally{s(!1)}};return j(()=>n.value,()=>{var t,a,e;return v({year:((t=n.value)==null?void 0:t.year)||NaN,filename:((a=n.value)==null?void 0:a.filename)||"",roleId:((e=n.value)==null?void 0:e.roleId)||NaN})}),P(async()=>{await o()}),(t,a)=>{const e=W,r=F,c=q("router-view");return u(),g("div",X,[l(e),l(k,{name:"sidebar",mode:"out-in",appear:""},{default:i(()=>[l(r,{items:y})]),_:1}),l(c,null,{default:i(({Component:D})=>[l(k,{name:"modal",mode:"out-in",appear:""},{default:i(()=>[(u(),H(z(D)))]),_:2},1024)]),_:1})])}}}),le=B(Y,[["__file","/home/runner/work/peer-assessment/peer-assessment/src/views/AdminResults.vue"]]);export{le as default};
