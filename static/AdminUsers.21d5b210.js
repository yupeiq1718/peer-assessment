import{a as G}from"./TheSideBar.d1d94cb3.js";import{_ as H}from"./BaseTable.a4c10453.js";import{_ as j,d as S,z as w,i as p,r as b,u as V,l as o,k as U,g as a,e as n,t as i,f as r,h as m,c,C as J,F as L,j as f,s as M,O as C,b as K,T,B as P}from"./index.f689cf9e.js";import{_ as Q}from"./BaseTag.d6f7bee9.js";import{u as k}from"./users.5f05567c.js";import{g as R,r as N,d as W}from"./data.ff9c2fa5.js";import"./api.80204498.js";const X={class:"flex justify-start items-center"},Y=["src"],Z={class:"text-sm 2xl:text-base"},ee={class:"text-sm 2xl:text-base text-muted"},te={class:"text-sm 2xl:text-base"},se={class:"text-sm 2xl:text-base"},ae={key:0,class:"flex justify-start items-center"},ne=["src"],oe={class:"text-sm 2xl:text-base"},re=S({__name:"AdminUsersMain",setup(z){const v=[{name:"\u59D3\u540D",key:"profile"},{name:"\u96FB\u5B50\u4FE1\u7BB1",key:"email",width:"25%"},{name:"\u90E8\u9580",key:"department",width:"10%"},{name:"\u89D2\u8272",key:"roles",width:"25%"},{name:"\u4E3B\u7BA1",key:"manager"},{name:"\u529F\u80FD",key:"function"}],B=w(()=>k().activeUsers),x=p("filterDepartment",b("")),l=p("filterRoles",b(0)),u=w(()=>{var s;return(s=B.value)==null?void 0:s.filter(t=>(!x.value||t.department===x.value)&&(!l.value||t.roles.includes(l.value)))}),$=w(()=>{var s;return(s=u.value)==null?void 0:s.map(t=>({profile:{name:t.name,picture:t.picture},email:t.email,department:t.department,roles:t.roles,manager:t.manager,function:t.id}))}),h=s=>W.findIndex(t=>s===t.value),_=p("setToastData",()=>null),g=p("setIsLoading",()=>null),y=async s=>{try{g(!0);const t=await k().deleteUser(s);_({isActive:!0,variant:"success",message:"\u522A\u9664\u6210\u529F"}),await k().readUsers()}catch{_({isActive:!0,variant:"error",message:"\u522A\u9664\u5931\u6557"})}finally{g(!1)}},D=p("setConfirmData",()=>null),A=s=>{D({isActive:!0,confirm:()=>y(s),text:"\u8ACB\u78BA\u8A8D\u662F\u5426\u522A\u9664\u8A72\u7B46\u8CC7\u6599\uFF1F"})},F=V(),O=s=>F.push(`/admin/users/edit/${s}`);return(s,t)=>{const E=Q,I=M,q=H;return o(),U(q,{fields:v,items:m($)},{profile:a(e=>[n("div",X,[n("img",{class:"inline-block rounded-full w-14 2xl:w-16 max-w-none h-14 2xl:h-16 bg-light mx-3 2xl:mx-4",src:e.data.picture||"/user.png",alt:"user"},null,8,Y),n("span",Z,i(e.data.name),1)])]),email:a(e=>[n("span",ee,i(e.data),1)]),department:a(e=>[r(E,{variant:m(R)(h(e.data))},{default:a(()=>[n("span",te,i(e.data),1)]),_:2},1032,["variant"])]),roles:a(e=>[(o(!0),c(L,null,J(e.data,d=>(o(),U(E,{key:d,variant:m(R)(d-1),class:"mx-1"},{default:a(()=>[n("span",se,i(m(N)[d-1].text),1)]),_:2},1032,["variant"]))),128))]),manager:a(e=>[e.data?(o(),c("div",ae,[n("img",{class:"inline-block rounded-full w-14 2xl:w-16 max-w-none h-14 2xl:h-16 bg-light mx-3 2xl:mx-4",src:e.data.picture||"/user.png",alt:"user"},null,8,ne),n("span",oe,i(e.data.name),1)])):f("v-if",!0)]),function:a(e=>[n("div",null,[r(I,{role:"button",class:"w-5 2xl:w-6 h-5 2xl:h-6 m-1 2xl:m-2 fill-muted hover:fill-theme hover:animate-bounce",name:"edit",onClick:d=>O(e.data)},null,8,["onClick"]),r(I,{role:"button",class:"w-5 2xl:w-6 h-5 2xl:h-6 m-1 2xl:m-2 fill-muted hover:fill-theme hover:animate-bounce",name:"delete",onClick:d=>A(e.data)},null,8,["onClick"])])]),_:1},8,["items"])}}}),le=j(re,[["__file","/home/runner/work/peer-assessment/peer-assessment/src/components/AdminUsersMain.vue"]]),ie={class:"absolute font-bold text-muted text-sm h-4 mb-2"},ue={key:0},ce={key:1},me={key:2},_e={key:0,class:"absolute top-8 left-0 w-full h-[calc(100%-2rem)] px-4 overflow-auto"},de=S({__name:"AdminUsers",setup(z){const v=V(),B=[{name:"\u65B0\u589E",icon:"plus",function:()=>v.push("/admin/users/new")},{name:"\u7BE9\u9078",icon:"filter",function:()=>v.push("/admin/users/filter")}],x=w(()=>k().users),l=b("");C("filterDepartment",l);const u=b(0);return C("filterRoles",u),C("setFilterData",({department:h,roles:_})=>{l.value=h,u.value=_}),(h,_)=>{const g=M,y=le,D=G,A=K("router-view");return o(),c(L,null,[n("span",ie,[r(g,{name:"users",class:"w-4 h-4 mr-2 fill-muted"}),!l.value&&!u.value?(o(),c("span",ue,i("\u5168\u90E8\u4F7F\u7528\u8005"))):f("v-if",!0),l.value?(o(),c("span",ce,i(l.value),1)):f("v-if",!0),u.value?(o(),c("span",me,i(m(N)[u.value-1].text),1)):f("v-if",!0)]),m(x)?(o(),c("div",_e,[r(y),r(T,{name:"sidebar",mode:"out-in",appear:""},{default:a(()=>[r(D,{items:B})]),_:1}),r(A,null,{default:a(({Component:F})=>[r(T,{name:"modal",mode:"out-in",appear:""},{default:a(()=>[(o(),U(P(F)))]),_:2},1024)]),_:1})])):f("v-if",!0)],64)}}}),ke=j(de,[["__file","/home/runner/work/peer-assessment/peer-assessment/src/views/AdminUsers.vue"]]);export{ke as default};
