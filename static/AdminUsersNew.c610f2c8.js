import{_ as w}from"./TheModal.23fd6fef.js";import{_ as x}from"./BaseFormTag.8cda039b.js";import{_ as E}from"./BaseFormSelect.289b026c.js";import{_ as A}from"./BaseFormInput.9cdf12d4.js";import{_ as I,d as U,A as N,i as c,u as q,k as y,g as b,h as o,o as k,e as T,f as t}from"./index.8e734258.js";import{u as a}from"./users.b6dbb148.js";import{u as $}from"./vee-validate.esm.ab02f1d5.js";import{d as S,r as V}from"./data.ff9c2fa5.js";import{b as L,c as n,d as j,a as z}from"./array.c60c04ee.js";import"./BaseMessage.65557bd2.js";import"./BaseTag.89a34d38.js";import"./BaseSelect.f6080912.js";import"./BaseInput.d313ad68.js";import"./api.5131a906.js";const M={class:"m-2 grid grid-cols-1 lg:grid-cols-2 2xl:grid-cols-3 gap-4"},O=U({__name:"AdminUsersNew",setup(R){const p=L({department:n().required("\u6B64\u6B04\u4F4D\u5FC5\u586B"),name:n().required("\u6B64\u6B04\u4F4D\u5FC5\u586B"),email:n().required("\u6B64\u6B04\u4F4D\u5FC5\u586B").test("email","\u4E0D\u7B26\u5408\u516C\u53F8\u96FB\u5B50\u90F5\u4EF6\u683C\u5F0F",e=>(e==null?void 0:e.includes("@osensetech.com"))&&(e==null?void 0:e.split("@osensetech.com")[1])===""||!1),roles:j().required("\u6B64\u6B04\u4F4D\u5FC5\u586B").min(1,"\u6700\u5C11\u9078\u64C7\u4E00\u9805"),managerId:z().required("\u6B64\u6B04\u4F4D\u5FC5\u586B")}),{setFieldValue:l,handleSubmit:_,resetForm:d}=$({validationSchema:p});l("roles",[]);const B=N(()=>{var e;return(e=a().activeUsers)==null?void 0:e.filter(s=>s.roles.includes(2)).map(s=>({text:s.name,value:s.id}))}),r=c("setToastData",()=>null),u=c("setIsLoading",()=>null),F=q(),f=_(async e=>{try{u(!0);const s=await a().createUser({name:e.name,email:e.email,department:e.department,roles:e.roles,managerId:Number(e.managerId)});r({isActive:!0,variant:"success",message:"\u65B0\u589E\u6210\u529F"}),d(),await a().readUsers()}catch({response:s}){r({isActive:!0,variant:"error",message:"\u65B0\u589E\u5931\u6557"})}finally{u(!1)}}),g=()=>F.push("/admin/users");return(e,s)=>{const m=A,i=E,C=x,h=w;return k(),y(h,{size:"full",onConfirm:o(f),onCancel:g},{default:b(()=>[T("article",M,[t(m,{name:"name",type:"text",class:"col-span-1",title:"\u59D3\u540D"}),t(m,{type:"email",name:"email",class:"col-span-1",title:"\u96FB\u5B50\u90F5\u4EF6"}),t(i,{name:"department",options:o(S),class:"col-span-1",title:"\u90E8\u9580"},null,8,["options"]),t(i,{name:"managerId",options:o(B),class:"col-span-1",title:"\u4E3B\u7BA1"},null,8,["options"]),t(C,{name:"roles",class:"col-span-1",title:"\u89D2\u8272",tags:o(V).map(D=>D.text)},null,8,["tags"])])]),_:1},8,["onConfirm"])}}}),oe=I(O,[["__file","/home/runner/work/peer-assessment/peer-assessment/src/views/AdminUsersNew.vue"]]);export{oe as default};
