import{_ as H,a as J}from"./TheSideBar.3f6676dc.js";import{_ as K}from"./BaseTable.13f3b5c8.js";import{_ as N,d as V,A as r,i as $,u as j,o as i,k as y,g as u,e as m,t as T,f as a,h as t,c as d,F as O,D as P,n as S,y as W,q as X,B as Y,b as Z,T as q,j as E,C as ee}from"./index.a3870a76.js";import{_ as te}from"./BaseScore.cd4b06ae.js";import{_ as se}from"./BaseTag.6a3ac365.js";import{u as x}from"./answers.ff01e3eb.js";import{u as L}from"./account.61220ef6.js";import{g as F,d as ne}from"./data.ff9c2fa5.js";import{u as Q}from"./system.fbb67b66.js";import{u as M}from"./questions.781054c8.js";import{u as oe}from"./users.d8e39637.js";import"./api.52db123a.js";const ae={class:"flex justify-start items-center"},re=["src"],ie={class:"text-sm 2xl:text-base"},ue={class:"text-sm 2xl:text-base"},le=["disabled","onClick"],ce=["disabled","onClick"],me=["disabled","onClick"],pe=V({__name:"EmployeeStaffMain",setup(R){const o=r(()=>Q().systemStatus),g=r(()=>L().accountId),b=[{name:"\u59D3\u540D",key:"profile"},{name:"\u90E8\u9580",key:"department",width:"20%"},{name:"\u8A55\u5206",key:"scores",width:"60%"},{name:"\u529F\u80FD",key:"function"}],k=r(()=>x().answersInformation(1)),A=r(()=>{var e;return(e=k.value)==null?void 0:e.map(n=>({profile:{name:n.reviewee.name,picture:n.reviewee.picture},department:n.reviewee.department,scores:n.answers.filter(w=>w.score===0||w.score),function:{id:n.id,isDone:n.isDone,reviewee:n.reviewee.id}}))}),f=e=>ne.findIndex(n=>e===n.value),v=$("setToastData",()=>null),h=$("setIsLoading",()=>null),c=async e=>{try{h(!0);const n=await x().deleteAnswersInformation(e);v({isActive:!0,variant:"success",message:"\u522A\u9664\u6210\u529F"}),x().readAnswersInformation({userId:g.value,qId:1})}catch{v({isActive:!0,variant:"error",message:"\u522A\u9664\u5931\u6557"})}finally{h(!1)}},l=j(),p=e=>l.push(`/employee/staff/edit/${e}`),C=e=>l.push(`/employee/staff/new?reviewee=${e}`),B=e=>{W().setConfirmData({isActive:!0,confirm:()=>c(e),text:"\u8ACB\u78BA\u8A8D\u662F\u5426\u522A\u9664\u8A72\u7B46\u8CC7\u6599\uFF1F"})};return(e,n)=>{const w=se,z=te,U=H,D=X,G=K;return i(),y(G,{fields:b,items:t(A)},{profile:u(s=>[m("div",ae,[m("img",{class:"inline-block rounded-full w-14 2xl:w-16 max-w-none h-14 2xl:h-16 bg-light mx-3 2xl:mx-4",src:s.data.picture||"/user.png",alt:"user"},null,8,re),m("span",ie,T(s.data.name),1)])]),department:u(s=>[a(w,{variant:t(F)(f(s.data))},{default:u(()=>[m("span",ue,T(s.data),1)]),_:2},1032,["variant"])]),scores:u(s=>[(i(!0),d(O,null,P(s.data,(_,I)=>(i(),d("div",{key:I,class:"relative group inline-block"},[a(z,{variant:t(F)(I),class:"w-16 2xl:w-18 h-16 2xl:h-18",score:_.score},null,8,["variant","score"]),a(U,{class:"absolute whitespace-nowrap left-1/2 bottom-18 2xl:bottom-20 -translate-x-1/2 opacity-0 group-hover:block lg:group-hover:opacity-100",variant:t(F)(I),text:_.tag},null,8,["variant","text"])]))),128))]),function:u(s=>[m("div",null,[t(o)==1&&!s.data.isDone?(i(),d("button",{key:0,disabled:t(o)!==1,class:S(t(o)==1?["fill-muted hover:fill-theme hover:animate-bounce"]:"fill-muted-light pointer-events-none"),onClick:_=>C(s.data.reviewee)},[a(D,{role:"button",class:"w-5 2xl:w-6 h-5 2xl:h-6 m-1 2xl:m-2",name:"edit"})],10,le)):(i(),d("button",{key:1,disabled:t(o)!==1,class:S(t(o)==1?["fill-muted hover:fill-theme hover:animate-bounce"]:"fill-muted-light pointer-events-none"),onClick:_=>p(s.data.id)},[a(D,{role:"button",class:"w-5 2xl:w-6 h-5 2xl:h-6 m-1 2xl:m-2",name:"edit"})],10,ce)),m("button",{disabled:!(t(o)==1&&s.data.isDone),class:S(t(o)==1&&s.data.isDone?["fill-muted hover:fill-theme hover:animate-bounce"]:"fill-muted-light pointer-events-none"),onClick:_=>B(s.data.id)},[a(D,{role:"button",class:"w-5 2xl:w-6 h-5 2xl:h-6 m-1 2xl:m-2",name:"delete"})],10,me)])]),_:1},8,["items"])}}}),_e=N(pe,[["__file","/home/runner/work/peer-assessment/peer-assessment/src/components/EmployeeStaffMain.vue"]]),de={key:0,class:"absolute w-full h-full pt-6 px-4"},fe=V({__name:"EmployeeStaff",setup(R){const o=r(()=>Q().systemStatus),g=r(()=>L().accountId),b=j(),k=r(()=>o.value===1?[{name:"\u65B0\u589E",icon:"plus",function:()=>b.push("/employee/staff/new")}]:[]),A=async c=>{try{const l=await M().readQuestionnaire(c)}catch{}},f=r(()=>M().questionnaire(1)),v=async({userId:c,qId:l})=>{try{const p=await x().readAnswersInformation({userId:c,qId:l})}catch{}},h=r(()=>oe().users);return Y(()=>{A(1),v({userId:g.value,qId:1})}),(c,l)=>{const p=_e,C=J,B=Z("router-view");return t(h)?(i(),d("div",de,[a(p),a(q,{name:"sidebar",mode:"out-in",appear:""},{default:u(()=>[t(f)?(i(),y(C,{key:0,items:t(k)},null,8,["items"])):E("v-if",!0)]),_:1}),t(f)?(i(),y(B,{key:0},{default:u(({Component:e})=>[a(q,{name:"modal",mode:"out-in",appear:""},{default:u(()=>[(i(),y(ee(e)))]),_:2},1024)]),_:1})):E("v-if",!0)])):E("v-if",!0)}}}),Ie=N(fe,[["__file","/home/runner/work/peer-assessment/peer-assessment/src/views/EmployeeStaff.vue"]]);export{Ie as default};
