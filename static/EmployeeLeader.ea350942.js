import{_ as H,a as J}from"./TheSideBar.932e7cb5.js";import{_ as K}from"./BaseTable.cabe33b8.js";import{_ as M,d as N,A as r,i as L,u as V,o as i,k as y,g as l,e as m,t as S,f as a,h as t,c as _,D as O,F as P,n as E,y as W,q as X,B as Y,b as Z,T,j as F,C as ee}from"./index.d2fd2b0d.js";import{_ as te}from"./BaseScore.093f6c51.js";import{_ as se}from"./BaseTag.ef7d74fc.js";import{u as x}from"./answers.d972aa5e.js";import{u as j}from"./account.403dcd26.js";import{g as $,d as ne}from"./data.ff9c2fa5.js";import{u as Q}from"./system.b0ca12ce.js";import{u as q}from"./questions.afc03da3.js";import{u as oe}from"./users.4045c21c.js";import"./api.f51c78f4.js";const ae={class:"flex justify-start items-center"},re=["src"],ie={class:"text-sm 2xl:text-base"},le={class:"text-sm 2xl:text-base"},ue=["disabled","onClick"],ce=["disabled","onClick"],me=["disabled","onClick"],de=N({__name:"EmployeeLeaderMain",setup(R){const o=r(()=>Q().systemStatus),g=r(()=>j().accountId),b=[{name:"\u59D3\u540D",key:"profile"},{name:"\u90E8\u9580",key:"department",width:"20%"},{name:"\u8A55\u5206",key:"scores",width:"60%"},{name:"\u529F\u80FD",key:"function"}],k=r(()=>x().answersInformation(2)),A=r(()=>{var e;return(e=k.value)==null?void 0:e.map(n=>({profile:{name:n.reviewee.name,picture:n.reviewee.picture},department:n.reviewee.department,scores:n.answers.filter(w=>w.score===0||w.score),function:{id:n.id,isDone:n.isDone,reviewee:n.reviewee.id}}))}),f=e=>ne.findIndex(n=>e===n.value),v=L("setToastData",()=>null),h=L("setIsLoading",()=>null),c=async e=>{try{h(!0);const n=await x().deleteAnswersInformation(e);v({isActive:!0,variant:"success",message:"\u522A\u9664\u6210\u529F"}),x().readAnswersInformation({userId:g.value,qId:2})}catch{v({isActive:!0,variant:"error",message:"\u522A\u9664\u5931\u6557"})}finally{h(!1)}},u=V(),d=e=>u.push(`/employee/leader/edit/${e}`),C=e=>u.push(`/employee/leader/new?reviewee=${e}`),B=e=>{W().setConfirmData({isActive:!0,confirm:()=>c(e),text:"\u8ACB\u78BA\u8A8D\u662F\u5426\u522A\u9664\u8A72\u7B46\u8CC7\u6599\uFF1F"})};return(e,n)=>{const w=se,z=te,U=H,D=X,G=K;return i(),y(G,{fields:b,items:t(A)},{profile:l(s=>[m("div",ae,[m("img",{class:"inline-block rounded-full w-14 2xl:w-16 max-w-none h-14 2xl:h-16 bg-light mx-3 2xl:mx-4",src:s.data.picture||"/user.png",alt:"user"},null,8,re),m("span",ie,S(s.data.name),1)])]),department:l(s=>[a(w,{variant:t($)(f(s.data))},{default:l(()=>[m("span",le,S(s.data),1)]),_:2},1032,["variant"])]),scores:l(s=>[(i(!0),_(P,null,O(s.data,(p,I)=>(i(),_("div",{key:I,class:"relative group inline-block"},[a(z,{variant:t($)(I),class:"w-16 2xl:w-18 h-16 2xl:h-18",score:p.score},null,8,["variant","score"]),a(U,{class:"absolute whitespace-nowrap left-1/2 bottom-18 2xl:bottom-20 -translate-x-1/2 opacity-0 group-hover:block lg:group-hover:opacity-100",variant:t($)(I),text:p.tag},null,8,["variant","text"])]))),128))]),function:l(s=>[m("div",null,[t(o)==1&&!s.data.isDone?(i(),_("button",{key:0,disabled:t(o)!==1,class:E(t(o)==1?["fill-muted hover:fill-theme hover:animate-bounce"]:"fill-muted-light pointer-events-none"),onClick:p=>C(s.data.reviewee)},[a(D,{role:"button",class:"w-5 2xl:w-6 h-5 2xl:h-6 m-1 2xl:m-2",name:"edit"})],10,ue)):(i(),_("button",{key:1,disabled:t(o)!==1,class:E(t(o)==1?["fill-muted hover:fill-theme hover:animate-bounce"]:"fill-muted-light pointer-events-none"),onClick:p=>d(s.data.id)},[a(D,{role:"button",class:"w-5 2xl:w-6 h-5 2xl:h-6 m-1 2xl:m-2",name:"edit"})],10,ce)),m("button",{disabled:!(t(o)==1&&s.data.isDone),class:E(t(o)==1&&s.data.isDone?["fill-muted hover:fill-theme hover:animate-bounce"]:"fill-muted-light pointer-events-none"),onClick:p=>B(s.data.id)},[a(D,{role:"button",class:"w-5 2xl:w-6 h-5 2xl:h-6 m-1 2xl:m-2",name:"delete"})],10,me)])]),_:1},8,["items"])}}}),pe=M(de,[["__file","/home/runner/work/peer-assessment/peer-assessment/src/components/EmployeeLeaderMain.vue"]]),_e={key:0,class:"absolute w-full h-full pt-6 px-4"},fe=N({__name:"EmployeeLeader",setup(R){const o=r(()=>Q().systemStatus),g=r(()=>j().accountId),b=V(),k=r(()=>o.value===1?[{name:"\u65B0\u589E",icon:"plus",function:()=>b.push("/employee/leader/new")}]:[]),A=async c=>{try{const u=await q().readQuestionnaire(c)}catch{}},f=r(()=>q().questionnaire(2)),v=async({userId:c,qId:u})=>{try{const d=await x().readAnswersInformation({userId:c,qId:u})}catch{}},h=r(()=>oe().users);return Y(()=>{A(2),v({userId:g.value,qId:2})}),(c,u)=>{const d=pe,C=J,B=Z("router-view");return t(h)?(i(),_("div",_e,[a(d),a(T,{name:"sidebar",mode:"out-in",appear:""},{default:l(()=>[t(f)?(i(),y(C,{key:0,items:t(k)},null,8,["items"])):F("v-if",!0)]),_:1}),t(f)?(i(),y(B,{key:0},{default:l(({Component:e})=>[a(T,{name:"modal",mode:"out-in",appear:""},{default:l(()=>[(i(),y(ee(e)))]),_:2},1024)]),_:1})):F("v-if",!0)])):F("v-if",!0)}}}),Ie=M(fe,[["__file","/home/runner/work/peer-assessment/peer-assessment/src/views/EmployeeLeader.vue"]]);export{Ie as default};
