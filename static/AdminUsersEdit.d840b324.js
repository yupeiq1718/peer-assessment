import{_ as A,a as q}from"./BaseFormSelect.444052c1.js";import{_ as N}from"./BaseFormTag.4bbc11e9.js";import{c as S,a as n,b as T,_ as k}from"./array.f16ea848.js";import{_ as I,d as V,m as u,i as f,S as $,x as L,f as R,w as j,u as o,o as z,a as M,b as t}from"./index.bfd7bb5a.js";import{u as r}from"./users.9fd8f47b.js";import{r as G,g as H}from"./data.ea6db125.js";import{a as J}from"./vee-validate.esm.18170894.js";import"./BaseMessage.9ad08472.js";import"./BaseSelect.30123327.js";import"./BaseTag.2b3902e8.js";import"./BaseInput.a3e76a86.js";import"./api.9b010a04.js";const K={class:"m-2 grid grid-cols-1 lg:grid-cols-2 2xl:grid-cols-3 gap-4"},O=V({__name:"AdminUsersEdit",setup(P){var l,p,d,_;const g=u(()=>H().map(e=>({value:e,text:e}))),m=f("setToastData",()=>null),s=f("setIsLoading",()=>null),v=$(),i=u(()=>v.params.id),a=u(()=>r().user(Number(i.value))),h=S({department:n().required("\u6B64\u6B04\u4F4D\u5FC5\u586B"),name:n().required("\u6B64\u6B04\u4F4D\u5FC5\u586B"),email:n().required("\u6B64\u6B04\u4F4D\u5FC5\u586B").email("\u4E0D\u7B26\u5408\u96FB\u5B50\u90F5\u4EF6\u683C\u5F0F"),role:T().required("\u6B64\u6B04\u4F4D\u5FC5\u586B").min(1,"\u6700\u5C11\u9078\u64C7\u4E00\u9805")}),{handleSubmit:C}=J({initialValues:{department:((l=a.value)==null?void 0:l.department)||"",email:((p=a.value)==null?void 0:p.email)||"",name:((d=a.value)==null?void 0:d.name)||"",role:((_=a.value)==null?void 0:_.role)||[]},validationSchema:h}),D=async()=>{try{s(!0);const e=await r().readUsers()}catch{}finally{s(!1)}},x=C(async e=>{try{s(!0);const B=await r().updateUser({id:Number(i.value),user:{name:e.name,department:e.department}});m({isActive:!0,variant:"success",message:"\u66F4\u65B0\u6210\u529F"}),c.push("/admin/users"),D()}catch({response:B}){m({isActive:!0,variant:"error",message:"\u66F4\u65B0\u5931\u6557"})}finally{s(!1)}}),c=L(),b=()=>c.push("/admin/users");return(e,B)=>{const F=k,y=q,E=N,U=A;return z(),R(U,{size:"full",onConfirm:o(x),onCancel:b},{default:j(()=>[M("article",K,[t(F,{name:"name",type:"text",class:"col-span-1",title:"\u59D3\u540D"}),t(F,{name:"email",class:"col-span-1",type:"email",title:"\u96FB\u5B50\u90F5\u4EF6",disabled:""}),t(y,{name:"department",options:o(g),class:"col-span-1",title:"\u90E8\u9580"},null,8,["options"]),t(E,{name:"role",class:"col-span-1 lg:col-span-2 2xl:col-span-3",title:"\u89D2\u8272",tags:o(G).map(w=>w.text),disabled:""},null,8,["tags"])])]),_:1},8,["onConfirm"])}}}),re=I(O,[["__file","/home/runner/work/peer-assessment/peer-assessment/src/views/AdminUsersEdit.vue"]]);export{re as default};
