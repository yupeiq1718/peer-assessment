import{_ as D,a as w}from"./BaseFormSelect.9047501e.js";import{_ as x}from"./BaseFormTag.21f1e5d0.js";import{_ as E}from"./BaseFormInput.889477ba.js";import{_ as U,d as A,z as y,i as c,u as N,k,g as q,h as o,l as I,e as T,f as t}from"./index.bd2cfc47.js";import{u as n}from"./users.d328b503.js";import{u as S}from"./vee-validate.esm.9b475a1d.js";import{d as V,r as $}from"./data.5612e520.js";import{c as b,a,d as z}from"./array.638ad13b.js";import"./BaseMessage.a3d245c2.js";import"./BaseSelect.aefaf5b3.js";import"./BaseTag.26f8522f.js";import"./BaseInput.84b7bb44.js";import"./api.074081fa.js";const L={class:"m-2 grid grid-cols-1 lg:grid-cols-2 2xl:grid-cols-3 gap-4"},j=A({__name:"AdminUsersNew",setup(M){const l=b({department:a().required("\u6B64\u6B04\u4F4D\u5FC5\u586B"),name:a().required("\u6B64\u6B04\u4F4D\u5FC5\u586B"),email:a().required("\u6B64\u6B04\u4F4D\u5FC5\u586B").test("email","\u4E0D\u7B26\u5408\u516C\u53F8\u96FB\u5B50\u90F5\u4EF6\u683C\u5F0F",e=>(e==null?void 0:e.includes("@osensetech.com"))&&(e==null?void 0:e.split("@osensetech.com")[1])===""||!1),role:z().required("\u6B64\u6B04\u4F4D\u5FC5\u586B").min(1,"\u6700\u5C11\u9078\u64C7\u4E00\u9805")}),{handleSubmit:p,resetForm:_}=S({initialValues:{department:"",email:"",name:"",role:[]},validationSchema:l}),d=y(()=>{var e;return(e=n().activeUsers)==null?void 0:e.filter(s=>s.role.includes(2)).map(s=>({text:s.name,value:s.id}))}),r=c("setToastData",()=>null),u=c("setIsLoading",()=>null),B=N(),f=p(async e=>{try{u(!0);const s=await n().createUser(e);r({isActive:!0,variant:"success",message:"\u65B0\u589E\u6210\u529F"}),_(),await n().readUsers()}catch({response:s}){r({isActive:!0,variant:"error",message:"\u65B0\u589E\u5931\u6557"})}finally{u(!1)}}),F=()=>B.push("/admin/users");return(e,s)=>{const i=E,m=w,g=x,h=D;return I(),k(h,{size:"full",onConfirm:o(f),onCancel:F},{default:q(()=>[T("article",L,[t(i,{name:"name",type:"text",class:"col-span-1",title:"\u59D3\u540D"}),t(i,{type:"email",name:"email",class:"col-span-1",title:"\u96FB\u5B50\u90F5\u4EF6"}),t(m,{name:"department",options:o(V),class:"col-span-1",title:"\u90E8\u9580"},null,8,["options"]),t(m,{name:"managerId",options:o(d),class:"col-span-1",title:"\u4E3B\u7BA1"},null,8,["options"]),t(g,{name:"role",class:"col-span-1",title:"\u89D2\u8272",tags:o($).map(C=>C.text)},null,8,["tags"])])]),_:1},8,["onConfirm"])}}}),ee=U(j,[["__file","/home/runner/work/peer-assessment/peer-assessment/src/views/AdminUsersNew.vue"]]);export{ee as default};
