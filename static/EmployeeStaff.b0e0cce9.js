import{_ as U}from"./TheSideBar.8cda3832.js";import{_ as G}from"./BaseTable.855b2d29.js";import{_ as q,d as V,z as o,i as C,u as M,l as r,k as f,g as a,e as m,t as D,f as l,q as H,h as s,c as N,C as J,F as K,n as F,s as O,A as P,b as W,T as E,j as S,B as X}from"./index.2995e7f5.js";import{_ as Y}from"./BaseScore.9bd55941.js";import{_ as Z}from"./BaseTag.de46f091.js";import{u as h}from"./answers.e7dd179a.js";import{u as j}from"./account.2f17e954.js";import{g as T,d as ee}from"./data.6ab9a877.js";import{u as L}from"./system.e8de7046.js";import{u as $}from"./questions.e47944b8.js";import{u as te}from"./users.be763f2c.js";import"./api.37b67db8.js";const se={class:"flex justify-start items-center"},ne=["src"],oe=["disabled","onClick"],ae=["disabled","onClick"],re=V({__name:"EmployeeStaffMain",setup(Q){const u=o(()=>L().systemStatus),y=o(()=>j().accountId),w=[{name:"\u59D3\u540D",key:"profile"},{name:"\u90E8\u9580",key:"department",width:"20%"},{name:"\u8A55\u5206",key:"scores",width:"60%"},{name:"\u529F\u80FD",key:"function"}],g=o(()=>{var e;return(e=h().answersInformation(1))==null?void 0:e.map(t=>({profile:{name:t.reviewee.name,picture:t.reviewee.picture},department:t.reviewee.department,scores:t.answers.filter(d=>d.score).map(d=>d.score),function:t.id}))}),A=e=>ee.findIndex(t=>e===t.value),p=C("setToastData",()=>null),v=C("setIsLoading",()=>null),k=async e=>{try{v(!0);const t=await h().deleteAnswersInformation(e);p({isActive:!0,variant:"success",message:"\u522A\u9664\u6210\u529F"}),h().readAnswersInformation({userId:y.value,qId:1})}catch{p({isActive:!0,variant:"error",message:"\u522A\u9664\u5931\u6557"})}finally{v(!1)}},i=M(),c=e=>i.push(`/employee/staff/edit/${e}`),_=C("setConfirmData",()=>null),I=e=>{_({isActive:!0,confirm:()=>k(e),text:"\u8ACB\u78BA\u8A8D\u662F\u5426\u522A\u9664\u8A72\u7B46\u8CC7\u6599\uFF1F"})};return(e,t)=>{const d=Z,z=Y,B=O,R=G;return r(),f(R,{fields:w,items:s(g)},{profile:a(n=>[m("div",se,[m("img",{class:"inline-block rounded-full w-16 max-w-none h-16 bg-light mr-4",src:n.data.picture||"/user.png",alt:"user"},null,8,ne),m("span",null,D(n.data.name),1)])]),department:a(n=>[l(d,{variant:s(T)(A(n.data))},{default:a(()=>[H(D(n.data),1)]),_:2},1032,["variant"])]),scores:a(n=>[(r(!0),N(K,null,J(n.data,(b,x)=>(r(),f(z,{key:x,variant:s(T)(x),class:"w-[4.5rem] h-[4.5rem]",score:b},null,8,["variant","score"]))),128))]),function:a(n=>[m("div",null,[m("button",{disabled:s(u)!==1,class:F(s(u)==1?["fill-muted hover:fill-theme"]:"fill-muted-light pointer-events-none"),onClick:b=>c(n.data)},[l(B,{role:"button",class:"w-6 h-6 m-2",name:"edit"})],10,oe),m("button",{disabled:s(u)!==1,class:F(s(u)==1?["fill-muted hover:fill-theme"]:"fill-muted-light pointer-events-none"),onClick:b=>I(n.data)},[l(B,{role:"button",class:"w-6 h-6 m-2",name:"delete"})],10,ae)])]),_:1},8,["items"])}}}),ue=q(re,[["__file","/home/runner/work/peer-assessment/peer-assessment/src/components/EmployeeStaffMain.vue"]]),ie={key:0,class:"absolute w-full h-full pt-6 px-4"},ce=V({__name:"EmployeeStaff",setup(Q){const u=o(()=>L().systemStatus),y=o(()=>j().accountId),w=M(),g=o(()=>u.value===1?[{name:"create",icon:"plus",function:()=>w.push("/employee/staff/new")}]:[]),A=async i=>{try{const c=await $().readQuestionnaire(i)}catch{}},p=o(()=>$().questionnaire(1)),v=async({userId:i,qId:c})=>{try{const _=await h().readAnswersInformation({userId:i,qId:c})}catch{}},k=o(()=>te().users);return P(()=>{A(1),v({userId:y.value,qId:1})}),(i,c)=>{const _=ue,I=U,e=W("router-view");return s(k)?(r(),N("div",ie,[l(_),l(E,{name:"sidebar",mode:"out-in",appear:""},{default:a(()=>[s(p)?(r(),f(I,{key:0,items:s(g)},null,8,["items"])):S("v-if",!0)]),_:1}),s(p)?(r(),f(e,{key:0},{default:a(({Component:t})=>[l(E,{name:"modal",mode:"out-in",appear:""},{default:a(()=>[(r(),f(X(t)))]),_:2},1024)]),_:1})):S("v-if",!0)])):S("v-if",!0)}}}),ke=q(ce,[["__file","/home/runner/work/peer-assessment/peer-assessment/src/views/EmployeeStaff.vue"]]);export{ke as default};
