import{_ as N,a as S}from"./BaseFormSelect.34adcd32.js";import{_ as k}from"./EmployeeAnswer.044e5298.js";import{_ as $,d as L,m as o,i as f,x as T,f as _,w as U,u as r,o as a,a as V,b as w,c as j,v as z,F as M}from"./index.708eb5c6.js";import{u as O}from"./questions.1acc58b7.js";import{u as n}from"./answers.52549a6e.js";import{u as Q}from"./users.ecad4c1a.js";import{u as R}from"./vee-validate.esm.64a4d8cc.js";import{c as v,a as B,b as u,d as G}from"./array.05a311f4.js";import{d as H}from"./data.054ee288.js";import"./BaseMessage.b99eec1c.js";import"./BaseSelect.e5e35936.js";import"./BaseFormTextarea.9ccf6510.js";import"./BaseTextarea.63f235fc.js";import"./BaseFormScore.b41d20d1.js";import"./BaseScore.d2fd7f85.js";import"./BaseTag.bd826634.js";import"./api.d802ac0b.js";const J={class:"mx-5 mt-5 mb-2 grid grid-cols-1 lg:grid-cols-2 2xl:grid-cols-3 gap-4"},K=L({__name:"EmployeeStaffNew",setup(P){var p;const i=o(()=>O().questions(1)),g=v().shape({department:B().required("\u6B64\u6B04\u4F4D\u5FC5\u586B"),reviewee:u().required("\u6B64\u6B04\u4F4D\u5FC5\u586B"),answers:G().of(v({qId:u().required("\u6B64\u6B04\u4F4D\u5FC5\u586B"),score:u(),comment:B()}))}),C={department:"\u7814\u767C\u90E8",reviewee:0,answers:((p=i.value)==null?void 0:p.map(e=>({qId:e.id,score:0,comment:""})))||[]},{values:F,handleSubmit:h}=R({initialValues:C,validationSchema:g}),x=o(()=>{var e;return(e=Q().users)==null?void 0:e.filter(s=>s.department===F.department)}),y=o(()=>n().answerUsers(1)),E=o(()=>{var e;return(e=x.value)==null?void 0:e.filter(s=>{var t;return!((t=y.value)!=null&&t.includes(s.id))}).map(s=>({text:s.name,value:s.id}))}),c=f("setToastData",()=>null),m=f("setIsLoading",()=>null),q=h(async e=>{try{m(!0);const s=await n().createAnswers({reviewer:1,qId:1,reviewee:Number(e.reviewee),answers:e.answers});c({isActive:!0,variant:"success",message:"\u65B0\u589E\u6210\u529F"}),n().readAnswersInformation({userId:1,qId:1}),l.push("/employee/staff")}catch({response:s}){c({isActive:!0,variant:"error",message:"\u65B0\u589E\u5931\u6557"})}finally{m(!1)}}),l=T(),I=()=>l.push("/employee/staff");return(e,s)=>{const t=S,b=k,A=N;return a(),_(A,{size:"full",onConfirm:r(q),onCancel:I},{default:U(()=>[V("article",J,[w(t,{name:"department",options:r(H),class:"col-span-1",title:"\u5408\u4F5C\u90E8\u9580"},null,8,["options"]),w(t,{name:"reviewee",options:r(E),class:"col-span-1",title:"\u5408\u4F5C\u5C0D\u8C61"},null,8,["options"]),(a(!0),j(M,null,z(r(i),(d,D)=>(a(),_(b,{id:d.id,key:d.id,index:D,"role-id":1,class:"col-span-1 lg:col-span-2 2xl:col-span-3"},null,8,["id","index"]))),128))])]),_:1},8,["onConfirm"])}}}),de=$(K,[["__file","/home/runner/work/peer-assessment/peer-assessment/src/views/EmployeeStaffNew.vue"]]);export{de as default};
