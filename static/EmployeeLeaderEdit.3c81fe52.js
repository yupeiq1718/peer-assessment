import{_ as q,a as D}from"./BaseFormSelect.6d70968b.js";import{_ as T}from"./EmployeeAnswer.1fe9f991.js";import{_ as V,d as z,z as t,a as M,i as h,u as R,A as U,k as y,g as j,h as o,l,e as r,f as I,c as O,C as Q,F as $}from"./index.a32bcd10.js";import{u as G}from"./questions.aa957120.js";import{u}from"./answers.c3da4145.js";import{u as H}from"./users.9a742a63.js";import{u as J}from"./vee-validate.esm.78d42f1b.js";import{d as K}from"./data.ff9c2fa5.js";import{u as P}from"./account.ef632e62.js";import{u as W}from"./system.37c5d4bb.js";import"./BaseMessage.647f0997.js";import"./BaseSelect.729da32e.js";import"./BaseFormTextarea.d65ceccb.js";import"./BaseTextarea.f608fa16.js";import"./BaseFormScore.4f7f5378.js";import"./BaseScore.46ec2b9e.js";import"./BaseTag.a01f1525.js";import"./array.f21bae85.js";import"./api.359bc57d.js";const X={class:"mx-5 mt-5 mb-2"},Y={class:"grid grid-cols-1 lg:grid-cols-2 2xl:grid-cols-3 gap-4"},Z=r("hr",{class:"border-1 border-theme my-4 w-full"},null,-1),ee={class:"grid grid-cols-1 lg:grid-cols-2 2xl:grid-cols-3 gap-4"},se=z({__name:"EmployeeLeaderEdit",setup(te){var _,f,v;const b=t(()=>W().systemStatus),c=t(()=>P().accountId),m=M(),x=t(()=>G().questions(2)),a=t(()=>u().answerInformation({qId:2,id:Number(m.params.id)})),{values:C,handleSubmit:F,setFieldValue:n}=J();n("department",(_=a.value)==null?void 0:_.reviewee.department),n("reviewee",(f=a.value)==null?void 0:f.reviewee.id),n("answers",((v=a.value)==null?void 0:v.answers)||[]);const E=t(()=>{var e;return(e=H().activeUsers)==null?void 0:e.filter(s=>s.department===C.department&&s.roles.includes(2))}),A=t(()=>{var e;return(e=E.value)==null?void 0:e.map(s=>({text:s.name,value:s.id}))}),p=h("setToastData",()=>null),d=h("setIsLoading",()=>null),B=F(async e=>{try{d(!0);const s=await u().updateAnswers({id:Number(m.params.id),reviewer:c.value,qId:2,reviewee:Number(e.reviewee),answers:e.answers});p({isActive:!0,variant:"success",message:"\u66F4\u65B0\u6210\u529F"}),u().readAnswersInformation({userId:c.value,qId:2}),i.push("/employee/leader")}catch({response:s}){p({isActive:!0,variant:"error",message:"\u66F4\u65B0\u5931\u6557"})}finally{d(!1)}}),i=R(),k=()=>i.push("/employee/leader");return U(()=>{b.value!==1&&i.push("/employee/leader")}),(e,s)=>{const w=D,L=T,N=q;return l(),y(N,{size:"full",onConfirm:o(B),onCancel:k},{default:j(()=>[r("article",X,[r("header",Y,[I(w,{name:"department",options:o(K),class:"col-span-1",title:"\u5408\u4F5C\u90E8\u9580",disabled:""},null,8,["options"]),I(w,{name:"reviewee",options:o(A),class:"col-span-1",title:"\u5408\u4F5C\u5C0D\u8C61",disabled:""},null,8,["options"])]),Z,r("article",ee,[(l(!0),O($,null,Q(o(x),(g,S)=>(l(),y(L,{id:g.id,key:g.id,index:S,"role-id":2,class:"col-span-1 lg:col-span-2 2xl:col-span-3"},null,8,["id","index"]))),128))])])]),_:1},8,["onConfirm"])}}}),be=V(se,[["__file","/home/runner/work/peer-assessment/peer-assessment/src/views/EmployeeLeaderEdit.vue"]]);export{be as default};
