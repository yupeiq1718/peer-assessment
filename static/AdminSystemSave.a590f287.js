import{_ as F}from"./TheModal.548419cb.js";import{_ as h}from"./BaseFormInput.fc272df9.js";import{v,r as A,_ as D,d as S,u as C,i as c,k as g,g as w,y as E,o as x,e as m,f as l}from"./index.0be65a8a.js";import{u as H}from"./vee-validate.esm.4a49d756.js";import{u as b}from"./system.f580cd77.js";import{u as p}from"./api.c2bc4a84.js";import{a as k,c as P}from"./array.5863a7c5.js";import"./BaseMessage.ef8b2797.js";import"./BaseInput.1b761b3c.js";const j=v("history",()=>{const a=A();return{createHistory:async({year:e,filename:r})=>{try{const s=await p.post("/history",{year:e,filename:r});return Promise.resolve(s)}catch(s){return Promise.reject(s)}},readHistory:async()=>{try{const e=await p.get("/history/filter");return a.value=e.data.data,Promise.resolve(e)}catch(e){return Promise.reject(e)}}}}),I={class:"m-2"},T={class:"m-2"},V=S({__name:"AdminSystemSave",setup(a){const u=C(),{handleSubmit:o,setFieldValue:e}=H();e("year",new Date().getFullYear());const r=c("setToastData",()=>null),s=c("setIsLoading",()=>null),y=()=>{E().setConfirmData({isActive:!0,confirm:()=>d(),text:"\u8ACB\u78BA\u8A8D\u662F\u5426\u5132\u5B58\u6240\u6709\u4E92\u8A55\u4E26\u7D50\u675F\u6B64\u6B21\u4E92\u8A55\u586B\u5BEB\uFF1F"})},_=async()=>{try{const t=await b().readSystemStatus()}catch({response:t}){}},d=o(async t=>{try{s(!0);const n=await j().createHistory({year:t.year,filename:t.filename});r({isActive:!0,variant:"success",message:"\u5132\u5B58\u6210\u529F"}),await _(),u.push("/admin/system")}catch({response:n}){r({isActive:!0,variant:"error",message:"\u5132\u5B58\u5931\u6557"})}finally{s(!1)}}),f=()=>u.push("/admin/system");return(t,n)=>{const i=h,B=F;return x(),g(B,{size:"side",onConfirm:y,onCancel:f},{default:w(()=>[m("div",I,[l(i,{class:"mb-4",title:"\u5E74\u5EA6",name:"year",type:"number",rule:k().typeError("\u6B64\u6B04\u4F4D\u683C\u5F0F\u4E0D\u7B26").min(1911,"\u6B64\u6B04\u4F4D\u683C\u5F0F\u4E0D\u7B26").required("\u6B64\u6B04\u4F4D\u5FC5\u586B")},null,8,["rule"])]),m("div",T,[l(i,{class:"mb-4",title:"\u540D\u7A31",name:"filename",type:"text",rule:P().required("\u6B64\u6B04\u4F4D\u5FC5\u586B")},null,8,["rule"])])]),_:1})}}}),J=D(V,[["__file","/home/runner/work/peer-assessment/peer-assessment/src/views/AdminSystemSave.vue"]]);export{J as default};
