import{_ as q,a as D}from"./BaseFormSelect.afd433bb.js";import{_ as L}from"./EmployeeAnswer.cbfa21c5.js";import{_ as T,d as V,z as t,a as z,i as h,u as R,k as y,g as U,h as o,l as i,e as r,f as I,c as j,C as M,F as O}from"./index.f9275dc0.js";import{u as Q}from"./questions.a40e6ab0.js";import{u as l}from"./answers.32aeb556.js";import{u as $}from"./users.718c968e.js";import{u as G}from"./vee-validate.esm.2fa19e08.js";import{d as H}from"./data.6ab9a877.js";import{u as J}from"./account.196a2185.js";import"./BaseMessage.77f410ae.js";import"./BaseSelect.5d3a8bd0.js";import"./BaseFormTextarea.5efc5a16.js";import"./BaseTextarea.234023bd.js";import"./BaseFormScore.c4750f06.js";import"./BaseScore.a30a3e8e.js";import"./BaseTag.134167dd.js";import"./array.e7991012.js";import"./api.29f17cea.js";const K={class:"mx-5 mt-5 mb-2"},P={class:"grid grid-cols-1 lg:grid-cols-2 2xl:grid-cols-3 gap-4"},W=r("hr",{class:"border-1 border-theme my-4 w-full"},null,-1),X={class:"grid grid-cols-1 lg:grid-cols-2 2xl:grid-cols-3 gap-4"},Y=V({__name:"EmployeeStaffEdit",setup(Z){var _,f,w;const u=t(()=>J().accountId),c=z(),b=t(()=>Q().questions(1)),a=t(()=>l().answerInformation({qId:1,id:Number(c.params.id)})),{values:x,handleSubmit:C,setFieldValue:n}=G();n("department",(_=a.value)==null?void 0:_.reviewee.department),n("reviewee",(f=a.value)==null?void 0:f.reviewee.id),n("answers",((w=a.value)==null?void 0:w.answers)||[]);const F=t(()=>{var e;return(e=$().activeUsers)==null?void 0:e.filter(s=>s.department===x.department&&s.roles.includes(1))}),E=t(()=>{var e;return(e=F.value)==null?void 0:e.map(s=>({text:s.name,value:s.id}))}),m=h("setToastData",()=>null),p=h("setIsLoading",()=>null),A=C(async e=>{try{p(!0);const s=await l().updateAnswers({id:Number(c.params.id),reviewer:u.value,qId:1,reviewee:Number(e.reviewee),answers:e.answers});m({isActive:!0,variant:"success",message:"\u66F4\u65B0\u6210\u529F"}),l().readAnswersInformation({userId:u.value,qId:1}),d.push("/employee/staff")}catch({response:s}){m({isActive:!0,variant:"error",message:"\u66F4\u65B0\u5931\u6557"})}finally{p(!1)}}),d=R(),B=()=>d.push("/employee/staff");return(e,s)=>{const g=D,k=L,N=q;return i(),y(N,{size:"full",onConfirm:o(A),onCancel:B},{default:U(()=>[r("article",K,[r("header",P,[I(g,{name:"department",options:o(H),class:"col-span-1",title:"\u5408\u4F5C\u90E8\u9580",disabled:""},null,8,["options"]),I(g,{name:"reviewee",options:o(E),class:"col-span-1",title:"\u5408\u4F5C\u5C0D\u8C61",disabled:""},null,8,["options"])]),W,r("article",X,[(i(!0),j(O,null,M(o(b),(v,S)=>(i(),y(k,{id:v.id,key:v.id,index:S,"role-id":1,class:"col-span-1 lg:col-span-2 2xl:col-span-3"},null,8,["id","index"]))),128))])])]),_:1},8,["onConfirm"])}}}),ve=T(Y,[["__file","/home/runner/work/peer-assessment/peer-assessment/src/views/EmployeeStaffEdit.vue"]]);export{ve as default};
